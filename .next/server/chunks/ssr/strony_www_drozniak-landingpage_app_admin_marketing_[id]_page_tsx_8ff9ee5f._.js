module.exports=[21338,a=>{"use strict";var b=a.i(73058),c=a.i(70994),d=a.i(90220),e=a.i(37056),f=a.i(12836),g=a.i(98329),h=a.i(65331),i=a.i(64736),j=a.i(96872),k=a.i(51789),l=a.i(55364),m=a.i(20706),n=a.i(69767),o=a.i(83626),p=a.i(19780),q=a.i(20667),r=a.i(91337),s=a.i(22909),t=a.i(83625),u=a.i(48955),v=a.i(9116),w=a.i(85909),x=a.i(90557),y=a.i(28298),z=a.i(49549),A=a.i(74826),B=a.i(57436),C=a.i(30832),D=a.i(68239),E=a.i(20934),F=a.i(32823),G=a.i(40155),H=a.i(34928),I=a.i(65593),J=a.i(17839),K=a.i(15868),L=a.i(4228),M=a.i(45569),N=a.i(51803),O=a.i(30638),P=a.i(59558),Q=a.i(11481),R=a.i(67941),S=a.i(61904),T=a.i(51838),U=a.i(75479),V=a.i(65013),W=a.i(90147),X=a.i(37173),Y=a.i(32297),Z=a.i(72014),$=a.i(375),_=a.i(11486),aa=a.i(20019),ab=a.i(99598),ac=a.i(29269),ad=a.i(53982),ae=a.i(37802),af=a.i(3242),ag=a.i(85668),ah=a.i(47847),ai=a.i(52328),aj=a.i(48829),ak=a.i(6626),al=a.i(50560),am=a.i(39450),an=a.i(34955),ao=a.i(30865),ap=a.i(55403),aq=a.i(48906),ar=a.i(1170),as=a.i(44544),at=a.i(38427),au=a.i(8507),av=a.i(79941),aw=a.i(73786),ax=a.i(43253),ay=a.i(54764),az=a.i(89439),aA=a.i(37052),aB=a.i(54050),aC=a.i(24603),aD=a.i(22759),aE=a.i(87733);let aF=(0,c.createContext)({isSelectMode:!1,onLongPressDeselect:()=>{}}),aG={"üì¢":"MegaphoneSimple","üîç":"MagnifyingGlass","üìß":"Envelope","üì±":"DeviceMobile","‚öôÔ∏è":"Gear","üåê":"Globe","üìÑ":"FileText","üí≥":"CreditCard","‚úÖ":"CheckCircle","üìù":"Notebook","üìä":"PresentationChart","üí¨":"ChatCircle","üìû":"Phone"},aH=(a,c=24,d="")=>{if(a.startsWith("simple:"))return((a,c=24,d="")=>{try{let e=g[`si${a.charAt(0).toUpperCase()+a.slice(1)}`];if(!e||!e.path)return null;return(0,b.jsx)("svg",{role:"img",viewBox:"0 0 24 24",width:c,height:c,className:d,fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,b.jsx)("path",{d:e.path})})}catch(a){return null}})(a.replace("simple:",""),c,d);let e={size:c,weight:"regular",className:d,color:"currentColor"};switch(aG[a]||a){case"MegaphoneSimple":return(0,b.jsx)(t.MegaphoneSimple,{...e});case"MagnifyingGlass":return(0,b.jsx)(u.MagnifyingGlass,{...e});case"Envelope":return(0,b.jsx)(v.Envelope,{...e});case"DeviceMobile":return(0,b.jsx)(w.DeviceMobile,{...e});case"Globe":return(0,b.jsx)(x.Globe,{...e});case"FileText":default:return(0,b.jsx)(y.FileText,{...e});case"CreditCard":return(0,b.jsx)(z.CreditCard,{...e});case"CheckCircle":return(0,b.jsx)(A.CheckCircle,{...e});case"Notebook":return(0,b.jsx)(B.Notebook,{...e});case"PresentationChart":return(0,b.jsx)(C.PresentationChart,{...e});case"ChatCircle":return(0,b.jsx)(D.ChatCircle,{...e});case"Phone":return(0,b.jsx)(E.Phone,{...e});case"Gear":return(0,b.jsx)(F.Gear,{...e});case"DotsThree":return(0,b.jsx)(G.DotsThree,{...e});case"Money":return(0,b.jsx)(H.Money,{...e});case"Wallet":return(0,b.jsx)(I.Wallet,{...e});case"ShoppingCart":return(0,b.jsx)(J.ShoppingCart,{...e});case"Tag":return(0,b.jsx)(K.Tag,{...e});case"CurrencyDollar":return(0,b.jsx)(L.CurrencyDollar,{...e});case"Storefront":return(0,b.jsx)(M.Storefront,{...e});case"TrendUp":return(0,b.jsx)(N.TrendUp,{...e});case"TrendDown":return(0,b.jsx)(O.TrendDown,{...e});case"ChartLine":return(0,b.jsx)(P.ChartLine,{...e});case"Users":return(0,b.jsx)(Q.Users,{...e});case"User":return(0,b.jsx)(R.User,{...e});case"Calendar":return(0,b.jsx)(S.Calendar,{...e});case"Clock":return(0,b.jsx)(T.Clock,{...e});case"PaperPlaneTilt":return(0,b.jsx)(U.PaperPlaneTilt,{...e});case"VideoCamera":return(0,b.jsx)(V.VideoCamera,{...e});case"Camera":return(0,b.jsx)(W.Camera,{...e});case"Image":return(0,b.jsx)(X.Image,{...e});case"Link":return(0,b.jsx)(Y.Link,{...e});case"Share":return(0,b.jsx)(Z.Share,{...e});case"Heart":return(0,b.jsx)($.Heart,{...e});case"Star":return(0,b.jsx)(_.Star,{...e});case"Bell":return(0,b.jsx)(aa.Bell,{...e});case"Warning":return(0,b.jsx)(ab.Warning,{...e});case"Info":return(0,b.jsx)(ac.Info,{...e});case"Question":return(0,b.jsx)(ad.Question,{...e});case"Check":return(0,b.jsx)(ae.Check,{...e});case"X":return(0,b.jsx)(af.X,{...e});case"Plus":return(0,b.jsx)(ag.Plus,{...e});case"Minus":return(0,b.jsx)(ah.Minus,{...e});case"ArrowRight":return(0,b.jsx)(ai.ArrowRight,{...e});case"ArrowLeft":return(0,b.jsx)(aj.ArrowLeft,{...e});case"ArrowUp":return(0,b.jsx)(ak.ArrowUp,{...e});case"ArrowDown":return(0,b.jsx)(al.ArrowDown,{...e});case"Download":return(0,b.jsx)(am.Download,{...e});case"Upload":return(0,b.jsx)(an.Upload,{...e});case"Eye":return(0,b.jsx)(ao.Eye,{...e});case"EyeSlash":return(0,b.jsx)(ap.EyeSlash,{...e});case"Lock":return(0,b.jsx)(aq.Lock,{...e});case"LockOpen":return(0,b.jsx)(ar.LockOpen,{...e});case"Key":return(0,b.jsx)(as.Key,{...e});case"Shield":return(0,b.jsx)(at.Shield,{...e});case"Trash":return(0,b.jsx)(au.Trash,{...e});case"Pencil":return(0,b.jsx)(av.Pencil,{...e});case"Copy":return(0,b.jsx)(aw.Copy,{...e});case"Clipboard":return(0,b.jsx)(ax.Clipboard,{...e});case"Folder":return(0,b.jsx)(ay.Folder,{...e});case"Database":return(0,b.jsx)(az.Database,{...e});case"Cloud":return(0,b.jsx)(aA.Cloud,{...e});case"WifiHigh":return(0,b.jsx)(aB.WifiHigh,{...e});case"Broadcast":return(0,b.jsx)(aC.Broadcast,{...e})}},aI={custom:({id:a,data:c,selected:d})=>(0,b.jsxs)("div",{className:`px-5 py-4 rounded-xl border-2 transition-all duration-200 min-w-[120px] relative group ${d?"border-[#fee715] shadow-lg shadow-[#fee715]/30 bg-[#18232F]":"border-[#fee715]/20 bg-[#0a0f14] hover:border-[#fee715]/50 hover:bg-[#18232F]"}`,style:{boxShadow:d?"0 0 20px rgba(254, 231, 21, 0.3)":"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[void 0!==c.commentCount&&c.commentCount>0&&(0,b.jsx)(s.CommentBadge,{count:c.commentCount,status:("closed"===c.commentStatus?"neutral":c.commentStatus)||"neutral",onClick:()=>{}}),(0,b.jsx)(e.Handle,{type:"source",position:f.Position.Top,id:"top",className:"!w-5 !h-5 !min-w-5 !min-h-5 bg-[#fee715] border-2 border-[#101820] hover:!w-6 hover:!h-6 transition-all cursor-crosshair z-10 opacity-0 group-hover:opacity-100",style:{top:-10},title:"PrzeciƒÖgnij do kropki na drugim panelu"}),(0,b.jsx)(e.Handle,{type:"source",position:f.Position.Bottom,id:"bottom",className:"!w-5 !h-5 !min-w-5 !min-h-5 bg-[#fee715] border-2 border-[#101820] hover:!w-6 hover:!h-6 transition-all cursor-crosshair z-10 opacity-0 group-hover:opacity-100",style:{bottom:-10},title:"PrzeciƒÖgnij do kropki na drugim panelu"}),(0,b.jsx)(e.Handle,{type:"source",position:f.Position.Left,id:"left",className:"!w-5 !h-5 !min-w-5 !min-h-5 bg-[#fee715] border-2 border-[#101820] hover:!w-6 hover:!h-6 transition-all cursor-crosshair z-10 opacity-0 group-hover:opacity-100",style:{left:-10},title:"PrzeciƒÖgnij do kropki na drugim panelu"}),(0,b.jsx)(e.Handle,{type:"source",position:f.Position.Right,id:"right",className:"!w-5 !h-5 !min-w-5 !min-h-5 bg-[#fee715] border-2 border-[#101820] hover:!w-6 hover:!h-6 transition-all cursor-crosshair z-10 opacity-0 group-hover:opacity-100",style:{right:-10},title:"PrzeciƒÖgnij do kropki na drugim panelu"}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center",style:{backgroundColor:c.color||"#fee71520",color:"#101820"},children:aH(c.icon,20)}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("div",{className:"text-sm font-medium text-white leading-tight",children:c.label})})]}),c.notes&&(0,b.jsx)("div",{className:"text-xs text-gray-400 mt-1 line-clamp-1",children:c.notes}),c.link&&(0,b.jsxs)("div",{className:"text-xs text-[#fee715] mt-1 line-clamp-1 flex items-center gap-1",children:[(0,b.jsx)(Y.Link,{size:12,weight:"bold"}),(0,b.jsx)("a",{href:c.link,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",onClick:a=>a.stopPropagation(),children:c.link.length>30?c.link.substring(0,30)+"...":c.link})]}),c.customFields&&c.customFields.length>0&&(0,b.jsx)("div",{className:"mt-2 pt-2 border-t border-white/5 space-y-1",children:c.customFields.map((a,c)=>(0,b.jsxs)("div",{className:"text-xs text-gray-400 flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-gray-500 font-medium",children:[a.field_name,":"]}),"link"===a.field_type?(0,b.jsx)("a",{href:a.field_value,target:"_blank",rel:"noopener noreferrer",className:"text-[#fee715] hover:underline line-clamp-1",onClick:a=>a.stopPropagation(),children:a.field_value.length>25?a.field_value.substring(0,25)+"...":a.field_value}):"date"===a.field_type?(0,b.jsx)("span",{children:a.field_value?new Date(a.field_value).toLocaleDateString("pl-PL"):"-"}):(0,b.jsx)("span",{className:"line-clamp-1",children:a.field_value||"-"})]},c))})]}),text:({id:a,data:c,selected:d,width:g,height:h})=>{let i=g||c.width||250,j=h||c.height||100;return(0,b.jsxs)("div",{className:`px-8 py-5 rounded-xl border-2 transition-all duration-200 relative group ${d?"border-[#fee715] shadow-lg shadow-[#fee715]/30 bg-[#18232F]":"border-[#fee715]/20 bg-[#0a0f14] hover:border-[#fee715]/50 hover:bg-[#18232F]"}`,style:{boxShadow:d?"0 0 20px rgba(254, 231, 21, 0.3)":"0 4px 6px rgba(0, 0, 0, 0.1)",width:i,height:j,minWidth:150,minHeight:60},children:[void 0!==c.commentCount&&c.commentCount>0&&(0,b.jsx)(s.CommentBadge,{count:c.commentCount,status:("closed"===c.commentStatus?"neutral":c.commentStatus)||"neutral",onClick:()=>{}}),c.showHandles&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Handle,{type:"source",position:f.Position.Top,id:"top",className:"!w-5 !h-5 !min-w-5 !min-h-5 bg-[#fee715] border-2 border-[#101820] hover:!w-6 hover:!h-6 transition-all cursor-crosshair z-10 opacity-0 group-hover:opacity-100",style:{top:-10},title:"PrzeciƒÖgnij do kropki na drugim panelu"}),(0,b.jsx)(e.Handle,{type:"source",position:f.Position.Bottom,id:"bottom",className:"!w-5 !h-5 !min-w-5 !min-h-5 bg-[#fee715] border-2 border-[#101820] hover:!w-6 hover:!h-6 transition-all cursor-crosshair z-10 opacity-0 group-hover:opacity-100",style:{bottom:-10},title:"PrzeciƒÖgnij do kropki na drugim panelu"}),(0,b.jsx)(e.Handle,{type:"source",position:f.Position.Left,id:"left",className:"!w-5 !h-5 !min-w-5 !min-h-5 bg-[#fee715] border-2 border-[#101820] hover:!w-6 hover:!h-6 transition-all cursor-crosshair z-10 opacity-0 group-hover:opacity-100",style:{left:-10},title:"PrzeciƒÖgnij do kropki na drugim panelu"}),(0,b.jsx)(e.Handle,{type:"source",position:f.Position.Right,id:"right",className:"!w-5 !h-5 !min-w-5 !min-h-5 bg-[#fee715] border-2 border-[#101820] hover:!w-6 hover:!h-6 transition-all cursor-crosshair z-10 opacity-0 group-hover:opacity-100",style:{right:-10},title:"PrzeciƒÖgnij do kropki na drugim panelu"})]}),(0,b.jsx)(e.NodeResizer,{color:"#fee715",isVisible:d,minWidth:150,minHeight:60,handleStyle:{backgroundColor:"#fee715",border:"2px solid #101820",borderRadius:"4px",width:"10px",height:"10px"}}),(0,b.jsx)("div",{className:"text-white break-words h-full w-full flex",style:{fontSize:c.fontSize||16,fontWeight:c.fontWeight||"normal",textAlign:c.textAlign||"left",justifyContent:"center"===c.textAlign?"center":"right"===c.textAlign?"flex-end":"flex-start",alignItems:"top"===c.verticalAlign?"flex-start":"bottom"===c.verticalAlign?"flex-end":"center",padding:"8px"},children:c.text||"Kliknij, aby edytowaƒá"})]})}},aJ={custom:({id:a,sourceX:d,sourceY:g,targetX:h,targetY:i,sourcePosition:j,targetPosition:k,data:l,style:m,markerEnd:n})=>{let[o,p,q]=(0,f.getSmoothStepPath)({sourceX:d,sourceY:g,sourcePosition:j,targetX:h,targetY:i,targetPosition:k,borderRadius:20}),r=c.default.useRef(null);c.default.useEffect(()=>{if(r.current)return;let a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",o),r.current=a},[o]);let[t,u]=c.default.useState(0),v=c.default.useRef(null);c.default.useEffect(()=>{if(!l?.notes||!v.current||!r.current)return;let a=setTimeout(()=>{let a=v.current;if(!a)return;let b=a.getBoundingClientRect(),c=document.querySelectorAll("[data-edge-label]"),d=!1;for(let e of c){if(e===a)continue;let c=e.getBoundingClientRect(),f=!(b.right+15<c.left||b.left-15>c.right),g=!(b.bottom+15<c.top||b.top-15>c.bottom);if(f&&g){d=!0;break}}if(d&&r.current)try{let d=r.current.getTotalLength(),e=d/2,f=.25*d,g=0;for(let d=30;d<=f;d+=30){let f=r.current.getPointAtLength(e-d),h={left:f.x-b.width/2,right:f.x+b.width/2,top:f.y-b.height/2,bottom:f.y+b.height/2},i=!1;for(let b of c){if(b===a)continue;let c=b.getBoundingClientRect(),d=!(h.right+15<c.left||h.left-15>c.right),e=!(h.bottom+15<c.top||h.top-15>c.bottom);if(d&&e){i=!0;break}}if(!i){g=-d;break}let j=r.current.getPointAtLength(e+d),k={left:j.x-b.width/2,right:j.x+b.width/2,top:j.y-b.height/2,bottom:j.y+b.height/2},l=!1;for(let b of c){if(b===a)continue;let c=b.getBoundingClientRect(),d=!(k.right+15<c.left||k.left-15>c.right),e=!(k.bottom+15<c.top||k.top-15>c.bottom);if(d&&e){l=!0;break}}if(!l){g=d;break}}u(g)}catch(a){}else u(0)},150);return()=>clearTimeout(a)},[l?.notes,o,p,q]);let w=c.default.useMemo(()=>{if(0===t||!r.current)return{x:p,y:q};try{let a=r.current.getTotalLength(),b=r.current.getPointAtLength(a/2+t);return{x:b.x,y:b.y}}catch(a){return{x:p,y:q}}},[p,q,t]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.BaseEdge,{id:a,path:o,style:m,markerEnd:n,markerStart:void 0}),l?.commentCount!==void 0&&l.commentCount>0&&(0,b.jsx)(e.EdgeLabelRenderer,{children:(0,b.jsx)("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${p}px,${q-20}px)`},className:"nodrag nopan",children:(0,b.jsx)(s.CommentBadge,{count:l.commentCount,status:("closed"===l.commentStatus?"neutral":l.commentStatus)||"neutral",onClick:()=>{}})})}),l?.notes&&(0,b.jsx)(e.EdgeLabelRenderer,{children:(0,b.jsx)("div",{ref:v,"data-edge-label":a,style:{position:"absolute",transform:`translate(-50%, -50%) translate(${w.x}px,${w.y}px)`},className:"nodrag nopan",children:(0,b.jsxs)("div",{className:"px-2 py-1 bg-[#fee715] text-[#101820] text-xs font-semibold rounded shadow-lg border-2 border-[#101820] max-w-[200px] break-words whitespace-normal leading-tight",children:[l.notes,l?.link&&(0,b.jsx)("a",{href:l.link,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),className:"block mt-1 text-[#101820] underline hover:text-blue-600",children:"üîó Link"})]})})})]})}},aK=[{type:"text",icon:"FileText",label:"Tekst",category:"Narzƒôdzia"},{type:"custom",icon:"simple:facebook",label:"Facebook Ads",color:"#1877F2",category:"≈πr√≥d≈Ça Ruchu"},{type:"custom",icon:"simple:google",label:"Google Ads",color:"#4285F4",category:"≈πr√≥d≈Ça Ruchu"},{type:"custom",icon:"Envelope",label:"Email",color:"#EA4335",category:"≈πr√≥d≈Ça Ruchu"},{type:"custom",icon:"simple:instagram",label:"Instagram",color:"#E4405F",category:"≈πr√≥d≈Ça Ruchu"},{type:"custom",icon:"simple:youtube",label:"Youtube",color:"#FF0000",category:"≈πr√≥d≈Ça Ruchu"},{type:"custom",icon:"Gear",label:"Inne",color:"#fee715",category:"≈πr√≥d≈Ça Ruchu",isCustom:!0},{type:"custom",icon:"Globe",label:"Landing",color:"#00C9A7",category:"Typ Strony"},{type:"custom",icon:"FileText",label:"Sales page",color:"#00C9A7",category:"Typ Strony"},{type:"custom",icon:"CreditCard",label:"Checkout",color:"#00C9A7",category:"Typ Strony"},{type:"custom",icon:"CheckCircle",label:"Thank you",color:"#00C9A7",category:"Typ Strony"},{type:"custom",icon:"Gear",label:"Inne",color:"#00C9A7",category:"Typ Strony",isCustom:!0},{type:"custom",icon:"Notebook",label:"Ebook",color:"#fee715",category:"Dzia≈Çania"},{type:"custom",icon:"Phone",label:"Rozmowa",color:"#fee715",category:"Dzia≈Çania"},{type:"custom",icon:"FileText",label:"Formularz",color:"#fee715",category:"Dzia≈Çania"},{type:"custom",icon:"PresentationChart",label:"Webinar",color:"#fee715",category:"Dzia≈Çania"},{type:"custom",icon:"Gear",label:"Inne",color:"#fee715",category:"Dzia≈Çania",isCustom:!0},{type:"custom",icon:"CheckCircle",label:"Lead",color:"#10B981",category:"Cel/Konwersja"},{type:"custom",icon:"Calendar",label:"Rezerwacja",color:"#10B981",category:"Cel/Konwersja"},{type:"custom",icon:"Phone",label:"Telefon",color:"#10B981",category:"Cel/Konwersja"},{type:"custom",icon:"CurrencyDollar",label:"Sprzeda≈º",color:"#10B981",category:"Cel/Konwersja"},{type:"custom",icon:"Gear",label:"Inne",color:"#10B981",category:"Cel/Konwersja",isCustom:!0}],aL=({value:a,onChange:e})=>{let[f,g]=(0,c.useState)(!1),h=(0,c.useRef)(null),i=(0,c.useRef)(null),[j,k]=(0,c.useState)({}),l=a=>{let b=a.getFullYear(),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0");return`${b}-${c}-${d}`},m=(()=>{let b=a?new Date(a+"T00:00:00"):new Date,c=b.getFullYear(),d=b.getMonth(),e=new Date(c,d,1),f=new Date(c,d+1,0).getDate(),g=0===e.getDay()?6:e.getDay()-1,h=[],i=new Date(c,d,0).getDate();for(let a=g-1;a>=0;a--)h.push({day:i-a,isCurrentMonth:!1,date:new Date(c,d-1,i-a)});for(let a=1;a<=f;a++)h.push({day:a,isCurrentMonth:!0,date:new Date(c,d,a)});let j=42-h.length;for(let a=1;a<=j;a++)h.push({day:a,isCurrentMonth:!1,date:new Date(c,d+1,a)});return{days:h,year:c,month:d}})(),n=a=>{e(l(a)),g(!1)},o=b=>{let c=a?new Date(a+"T00:00:00"):new Date;e(l(new Date(c.getFullYear(),c.getMonth()+b,1)))};return(0,c.useEffect)(()=>{if(!f)return;let a=()=>{let a=h.current,b=i.current;if(!a||!b)return;let c=a.getBoundingClientRect(),d=b.getBoundingClientRect(),e=c.bottom+8;e+d.height>window.innerHeight-12&&(e=c.top-d.height-8),e=Math.max(12,Math.min(e,window.innerHeight-d.height-12));let f=c.left;f+280>window.innerWidth-12&&(f=window.innerWidth-280-12),f<12&&(f=12),k({position:"fixed",zIndex:99999,top:`${e}px`,left:`${f}px`,width:"280px"})},b=requestAnimationFrame(a);return window.addEventListener("scroll",a,!0),window.addEventListener("resize",a),()=>{cancelAnimationFrame(b),window.removeEventListener("scroll",a,!0),window.removeEventListener("resize",a)}},[f]),(0,c.useEffect)(()=>{let a=a=>{let b=a.target;f&&b&&h.current&&!h.current.contains(b)&&i.current&&!i.current.contains(b)&&g(!1)};return f&&(document.addEventListener("mousedown",a),document.addEventListener("keydown",a=>{"Escape"===a.key&&g(!1)})),()=>{document.removeEventListener("mousedown",a)}},[f]),(0,b.jsxs)("div",{className:"relative",ref:h,children:[(0,b.jsxs)("button",{type:"button",onClick:()=>g(!f),className:"w-full bg-white/[0.04] border border-white/10 rounded px-2 py-1 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30 flex items-center justify-between",children:[(0,b.jsx)("span",{className:a?"text-white":"text-gray-500",children:a?new Date(a+"T00:00:00").toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"}):"dd.mm.rrrr"}),(0,b.jsx)("svg",{className:"w-4 h-4 text-white flex-shrink-0 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]}),f&&(0,d.createPortal)((0,b.jsxs)("div",{ref:i,className:"fixed bg-[#18232F] border border-white/15 rounded-lg shadow-xl p-4",style:Object.keys(j).length?j:{zIndex:99999},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>o(-1),className:"p-1 rounded hover:bg-white/10 transition-colors",children:(0,b.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,b.jsxs)("h3",{className:"text-white text-sm font-medium",children:[["Stycze≈Ñ","Luty","Marzec","Kwiecie≈Ñ","Maj","Czerwiec","Lipiec","Sierpie≈Ñ","Wrzesie≈Ñ","Pa≈∫dziernik","Listopad","Grudzie≈Ñ"][m.month]," ",m.year]}),(0,b.jsx)("button",{type:"button",onClick:()=>o(1),className:"p-1 rounded hover:bg-white/10 transition-colors",children:(0,b.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(0,b.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Pon","Wt","≈ör","Czw","Pt","Sob","Nie"].map((a,c)=>(0,b.jsx)("div",{className:"text-center text-[10px] text-gray-400 py-1",children:a},c))}),(0,b.jsx)("div",{className:"grid grid-cols-7 gap-1",children:m.days.map((c,d)=>{let e=a&&l(c.date)===a,f=l(c.date)===l(new Date);return(0,b.jsx)("button",{type:"button",onClick:()=>c.isCurrentMonth&&n(c.date),disabled:!c.isCurrentMonth,className:`aspect-square rounded text-[11px] font-medium transition-all ${!c.isCurrentMonth?"text-gray-600 cursor-not-allowed":e?"bg-[#fee715] text-[#101820] font-bold":f?"bg-white/10 text-[#fee715] border border-[#fee715]/50":"text-white hover:bg-white/10"}`,children:c.day},d)})}),(0,b.jsxs)("div",{className:"flex gap-2 mt-3 pt-3 border-t border-white/10",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{e(""),g(!1)},className:"flex-1 px-2 py-1.5 bg-white/5 hover:bg-white/10 border border-white/20 rounded text-white text-[10px] transition-colors",children:"Wyczy≈õƒá"}),(0,b.jsx)("button",{type:"button",onClick:()=>{n(new Date)},className:"flex-1 px-2 py-1.5 bg-[#fee715] text-[#101820] rounded text-[10px] font-bold transition-colors hover:bg-[#fee715]/90",children:"Dzisiaj"})]})]}),document.body)]})};function aM({params:a}){let[d,g]=(0,c.useState)(null),[s,t]=(0,c.useState)(null);(0,c.useEffect)(()=>{a.then(a=>{g(a),t(a.id)})},[a]);let{user:u}=(0,i.useAuth)(),v=(0,h.useRouter)(),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)("select"),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)([]),[S,T]=(0,c.useState)({label:"",icon:"FileText",notes:"",link:"",isPinned:!1}),[U,V]=(0,c.useState)([]),[W,X]=(0,c.useState)({text:"",fontSize:18,fontWeight:"bold",textAlign:"left",verticalAlign:"middle",showHandles:!1,isPinned:!1}),[Y,Z]=(0,c.useState)(null),[$,_]=(0,c.useState)({notes:"",link:""}),[aa,ab]=(0,c.useState)([]),[ac,ad]=(0,c.useState)(!1),[ae,af]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(!1),[ak,al]=(0,c.useState)(!0),[am,an]=(0,c.useState)(!0),[ao,ap]=(0,c.useState)(!0),[aq,ar]=(0,c.useState)(!1),[as,at]=(0,c.useState)("pan"),[av,aw]=(0,c.useState)({isOpen:!1,title:"",message:"",type:"info"}),[ax,ay]=(0,c.useState)(!1),[az,aA]=(0,c.useState)(!1),[aB,aC]=(0,c.useState)(null),[aG,aM]=(0,c.useState)(null),[aN,aO]=(0,c.useState)(new Map),[aP,aQ]=(0,c.useState)(new Map),[aR,aS]=(0,c.useState)(0),[aT,aU,aV]=(0,e.useNodesState)([]),[aW,aX,aY]=(0,e.useEdgesState)([]),aZ=(0,c.useRef)([]);(0,c.useEffect)(()=>{aZ.current=aT},[aT]);let[a$,a_]=(0,c.useState)([]),a0=(0,c.useRef)(null),a1=(0,c.useRef)(!1),a2=(0,c.useRef)(!1),a3=(0,c.useRef)(null),[a4,a5]=(0,c.useState)(!1),a6=(0,c.useRef)(null),a7=(0,c.useRef)(null),a8=(0,c.useRef)(null),[a9,ba]=(0,c.useState)(!1),[bb,bc]=(0,c.useState)(!1),[bd,be]=(0,c.useState)(!1),[bf,bg]=(0,c.useState)(null),[bh,bi]=(0,c.useState)([]),[bj,bk]=(0,c.useState)([]),[bl,bm]=(0,c.useState)(!1),[bn,bo]=(0,c.useState)(1),[bp,bq]=(0,c.useState)({vertical:[],horizontal:[]}),[br,bs]=(0,c.useState)({x:0,y:0,zoom:1}),[bt,bu]=(0,c.useState)({w:0,h:0}),bv=(0,c.useRef)(!1),bw=(0,c.useRef)(null),bx=(0,c.useRef)(new Set),by=(0,c.useRef)(!1),bz=(0,c.useCallback)(()=>{let a={nodes:JSON.parse(JSON.stringify(aT)),edges:JSON.parse(JSON.stringify(aW))};a_(b=>{let c=[...b,a];return c.length>50?c.slice(1):c})},[aT,aW]),bA=(0,c.useCallback)(()=>{if(0===a$.length)return;let a=a$[a$.length-1];aU(a.nodes),aX(a.edges),a_(a=>a.slice(0,-1)),N(null),Z(null),P(!1),ad(!1)},[a$,aU,aX]);(0,c.useEffect)(()=>{let a=a0.current;if(!a)return;let b=()=>{a&&bu({w:a.offsetWidth,h:a.offsetHeight})};b();let c=new ResizeObserver(b);return c.observe(a),()=>c.disconnect()},[]);let bB=(0,c.useCallback)(async()=>{if(u)try{let{data:a,error:b}=await j.supabase.from("custom_node_templates").select("*").eq("created_by",u.id).order("created_at",{ascending:!1});if(b)throw b;let c=(a||[]).map(a=>({type:"custom",icon:a.icon,label:a.label,color:a.color,category:a.category,isCustom:!0}));R(c)}catch(a){console.error("B≈ÇƒÖd ≈Çadowania w≈Çasnych szablon√≥w:",a)}},[u]),bC=(0,c.useCallback)(async()=>{if(s)try{let{data:a,error:b}=await j.supabase.from("comment_threads").select(`
          id,
          status,
          comment_anchors (
            anchor_type,
            anchor_id,
            region_x,
            region_y,
            region_width,
            region_height
          )
        `).eq("funnel_id",s);if(b)throw console.error("B≈ÇƒÖd pobierania wƒÖtk√≥w:",b),b;console.log("=== RAW DATA FROM DB ==="),console.log("Threads count:",a?.length||0),a&&a.length>0&&(console.log("First thread raw data:",JSON.stringify(a[0],null,2)),console.log("All threads anchors:",a.map(a=>{let b=a.comment_anchors,c=Array.isArray(b)?b[0]:b;return{threadId:a.id,anchors:b,isArray:Array.isArray(b),anchorsLength:Array.isArray(b)?b.length:+!!b,firstAnchor:c}})));let c=new Map,d=new Map;(a||[]).forEach(a=>{let b=a.comment_anchors,e=Array.isArray(b)?b[0]:b;if(!e||!e.anchor_type||"Zatwierdzone"===a.status||"Odrzucone"===a.status)return;let f="neutral";if("Otwarte"===a.status?f="warning":"Do akceptacji"===a.status?f="pending":"W toku"===a.status&&(f="neutral"),"node"===e.anchor_type&&e.anchor_id){let a=c.get(e.anchor_id)||{count:0,status:"neutral"};c.set(e.anchor_id,{count:a.count+1,status:"warning"===f||"warning"===a.status?"warning":"pending"===f||"pending"===a.status?"pending":"neutral"})}else if("edge"===e.anchor_type&&e.anchor_id){let a=d.get(e.anchor_id)||{count:0,status:"neutral"};d.set(e.anchor_id,{count:a.count+1,status:"warning"===f||"warning"===a.status?"warning":"pending"===f||"pending"===a.status?"pending":"neutral"})}}),aO(c),aQ(d);let e=(a||[]).map(a=>{let b=a.comment_anchors,c=Array.isArray(b)?b[0]:b;return{threadId:a.id,anchorType:c?.anchor_type,anchorId:c?.anchor_id,anchorIdType:typeof c?.anchor_id,anchorIdValue:c?.anchor_id,status:a.status,isOpen:"Zatwierdzone"!==a.status&&"Odrzucone"!==a.status,fullAnchor:c}});console.log("=== DEBUG: Za≈Çadowane liczniki komentarzy ==="),console.log("Total threads:",a?.length||0),console.log("Node counts:",Array.from(c.entries())),console.log("Edge counts:",Array.from(d.entries())),console.log("All anchors info (szczeg√≥≈Çy):",JSON.stringify(e,null,2)),console.log("Nodes with comments:",Array.from(c.keys())),console.log("Edges with comments:",Array.from(d.keys())),(a||[]).forEach(a=>{let b=a.comment_anchors,c=Array.isArray(b)?b[0]:b;c&&c.anchor_type?"region"===c.anchor_type?console.log("‚ÑπÔ∏è Thread dla regionu (pomijany):",a.id):"node"!==c.anchor_type||c.anchor_id?"edge"!==c.anchor_type||c.anchor_id?("Zatwierdzone"===a.status||"Odrzucone"===a.status)&&console.log("‚ÑπÔ∏è Thread zamkniƒôty (pomijany):",a.id,a.status):console.warn("‚ö†Ô∏è Thread dla edge bez anchor_id:",a.id,c):console.warn("‚ö†Ô∏è Thread dla node bez anchor_id:",a.id,c):console.warn("‚ö†Ô∏è Thread bez anchor:",a.id)})}catch(a){console.error("B≈ÇƒÖd ≈Çadowania liczby wƒÖtk√≥w:",a)}},[s]);(0,c.useEffect)(()=>{s&&u&&(bK(),bB(),bC())},[s,u,bB,bC]),(0,c.useEffect)(()=>{if(!bf||!w||0===aT.length||a2.current)return;let a=aT.find(a=>(a.type,!0===a.data.isPinned));if(a2.current=!0,a){a1.current=!0;let b=()=>{if(!bf||!a0.current)return void requestAnimationFrame(b);let c=aT.find(b=>b.id===a.id);if(!c){console.warn("Przypiƒôty node nie zosta≈Ç znaleziony:",a.id),bf.setViewport({x:0,y:0,zoom:.48},{duration:0});return}let d=c.width||c.measured?.width||("text"===c.type?250:150),e=c.height||c.measured?.height||("text"===c.type?100:80),f=c.position.x+d/2,g=c.position.y+e/2,h=a0.current.offsetWidth,i=a0.current.offsetHeight;bf.setViewport({x:h/2-.48*f,y:i/2-.48*g,zoom:.48},{duration:200})};requestAnimationFrame(()=>{requestAnimationFrame(b)})}else{let a=()=>{bf?bf.fitView({padding:.2,duration:200}):requestAnimationFrame(a)};requestAnimationFrame(()=>{requestAnimationFrame(a)})}},[bf,w,aT,br]),(0,c.useEffect)(()=>{s&&(a1.current=!1,a2.current=!1)},[s]),(0,c.useEffect)(()=>{if(!a3.current){a3.current={nodes:JSON.parse(JSON.stringify(aT)),edges:JSON.parse(JSON.stringify(aW))},a5(!1);return}a5(JSON.stringify({nodes:aT,edges:aW})!==JSON.stringify(a3.current))},[aT,aW]),(0,c.useEffect)(()=>{if(w&&aT.length>=0&&!O&&!ac){let a=setTimeout(()=>{bL()},2e3);return()=>clearTimeout(a)}},[aT,aW,w,O,ac]);let bD=(0,c.useCallback)(()=>{let a=aT.filter(a=>a.selected);if(0===a.length)return;let b=new Set(a.map(a=>a.id)),c=aW.filter(a=>b.has(a.source)&&b.has(a.target));bi(JSON.parse(JSON.stringify(a))),bk(JSON.parse(JSON.stringify(c)))},[aT,aW]),bE=(0,c.useCallback)(()=>{if(0===bh.length||!bf)return;bz();let a=bh.map(a=>{let b=`${"text"===a.type?"text-node":"node"}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;return{...a,id:b,selected:!1,position:{x:a.position.x+50,y:a.position.y+50}}}),b=new Map;bh.forEach((c,d)=>{b.set(c.id,a[d].id)});let c=bj.map(a=>{let c=`edge-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;return{...a,id:c,source:b.get(a.source)||a.source,target:b.get(a.target)||a.target,selected:!1}});aU(b=>[...b,...a]),aX(a=>[...a,...c])},[bh,bj,bf,aU,aX,bz]);(0,c.useEffect)(()=>{let a=a=>!!a&&a instanceof HTMLElement&&("INPUT"===a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||!0===a.isContentEditable),b=b=>{if(!(a(b.target)||a(document.activeElement))){if((b.metaKey||b.ctrlKey)&&"z"===b.key&&!b.shiftKey){b.preventDefault(),bA();return}if((b.metaKey||b.ctrlKey)&&"c"===b.key){b.preventDefault(),bD();return}if((b.metaKey||b.ctrlKey)&&"v"===b.key){b.preventDefault(),bE();return}"Space"!==b.code||b.repeat||(b.preventDefault(),bm(!0))}},c=b=>{a(b.target)||a(document.activeElement)||"Space"===b.code&&(b.preventDefault(),bm(!1))};return window.addEventListener("keydown",b),window.addEventListener("keyup",c),()=>{window.removeEventListener("keydown",b),window.removeEventListener("keyup",c)}},[bA,bD,bE]);let bF=(0,c.useCallback)(async(a,b,c,d)=>{if(u)try{let{error:e}=await j.supabase.from("custom_node_templates").insert({created_by:u.id,label:a,icon:b,color:c,category:d});if(e)throw e;await bB(),aw({isOpen:!0,title:"Sukces",message:"Szablon zosta≈Ç zapisany i dodany do sidebaru!",type:"success"})}catch(a){console.error("B≈ÇƒÖd zapisywania szablonu:",a),aw({isOpen:!0,title:"B≈ÇƒÖd",message:"Nie uda≈Ço siƒô zapisaƒá szablonu: "+(a.message||"Nieznany b≈ÇƒÖd"),type:"error"})}},[u,bB]),bG=(0,c.useCallback)(async(a,b)=>{try{let{data:c,error:d}=await j.supabase.from("node_custom_fields").select("*").eq("funnel_id",b).eq("node_id",a).order("display_order",{ascending:!0});if(d)throw d;let e=(c||[]).map(a=>({id:a.id,field_name:a.field_name,field_type:a.field_type,field_value:a.field_value||"",display_order:a.display_order||0}));V(e)}catch(a){console.error("B≈ÇƒÖd ≈Çadowania customowych p√≥l:",a)}},[]),bH=(0,c.useCallback)(async(a,b,c)=>{try{let{error:d}=await j.supabase.from("node_custom_fields").delete().eq("funnel_id",b).eq("node_id",a);if(d)throw d;if(c.length>0){let d=c.map((c,d)=>({funnel_id:b,node_id:a,field_name:c.field_name,field_type:c.field_type,field_value:c.field_value||"",display_order:d})),{error:e}=await j.supabase.from("node_custom_fields").insert(d);if(e)throw e}}catch(a){throw console.error("B≈ÇƒÖd zapisywania customowych p√≥l:",a),a}},[]),bI=(0,c.useCallback)(async(a,b)=>{try{let{data:c,error:d}=await j.supabase.from("edge_custom_fields").select("*").eq("funnel_id",b).eq("edge_id",a).order("display_order",{ascending:!0});if(d)throw d;let e=(c||[]).map(a=>({id:a.id,field_name:a.field_name,field_type:a.field_type,field_value:a.field_value||"",display_order:a.display_order||0}));ab(e)}catch(a){console.error("B≈ÇƒÖd ≈Çadowania customowych p√≥l dla edge:",a)}},[]),bJ=(0,c.useCallback)(async(a,b,c)=>{try{let{error:d}=await j.supabase.from("edge_custom_fields").delete().eq("funnel_id",b).eq("edge_id",a);if(d)throw d;if(c.length>0){let d=c.map((c,d)=>({funnel_id:b,edge_id:a,field_name:c.field_name,field_type:c.field_type,field_value:c.field_value||"",display_order:d})),{error:e}=await j.supabase.from("edge_custom_fields").insert(d);if(e)throw e}}catch(a){throw console.error("B≈ÇƒÖd zapisywania customowych p√≥l dla edge:",a),a}},[]),bK=async()=>{try{z(!0);let{data:a,error:b}=await j.supabase.from("funnel_diagrams").select("*").eq("id",s).single();if(b)throw b;if(x(a),H(a.project_name||""),J(a.subtitle||""),a.subtitle&&!["stan obecny","docelowy","Plan 90 dni"].includes(a.subtitle)?L("custom"):L("select"),a.diagram_data){let b=a.diagram_data,c=b.nodes||[];if(c.length>0&&s)try{let{data:a,error:b}=await j.supabase.from("node_custom_fields").select("*").eq("funnel_id",s).order("display_order",{ascending:!0});if(!b&&a){let b={};a.forEach(a=>{b[a.node_id]||(b[a.node_id]=[]),b[a.node_id].push({id:a.id,field_name:a.field_name,field_type:a.field_type,field_value:a.field_value||"",display_order:a.display_order||0})}),c=c.map(a=>"custom"===a.type&&b[a.id]?{...a,data:{...a.data,customFields:b[a.id]}}:a)}}catch(a){console.error("B≈ÇƒÖd ≈Çadowania customowych p√≥l:",a)}c&&Array.isArray(c)&&aU(c),b.edges&&Array.isArray(b.edges)&&aX(b.edges),b.viewport&&bs(b.viewport),a_([]),a2.current=!1,a3.current={nodes:JSON.parse(JSON.stringify(c||[])),edges:JSON.parse(JSON.stringify(b.edges||[]))},a5(!1)}}catch(a){console.error("B≈ÇƒÖd ≈Çadowania lejka:",a),aw({isOpen:!0,title:"B≈ÇƒÖd",message:"Nie uda≈Ço siƒô za≈Çadowaƒá lejka: "+(a.message||"Nieznany b≈ÇƒÖd"),type:"error"})}finally{z(!1)}},bL=async()=>{if(w&&bf)try{B(!0);let a=bf.getViewport(),{error:b}=await j.supabase.from("funnel_diagrams").update({diagram_data:{nodes:aT,edges:aW,viewport:a},project_name:G,subtitle:I,updated_at:new Date().toISOString()}).eq("id",w.id);if(b)throw b;a3.current={nodes:JSON.parse(JSON.stringify(aT)),edges:JSON.parse(JSON.stringify(aW))},a5(!1)}catch(a){console.error("B≈ÇƒÖd zapisywania lejka:",a)}finally{B(!1)}},bM=(0,c.useCallback)(a=>{bz();let b={...a,id:`edge-${a.source}-${a.target}-${Date.now()}`,type:"custom",animated:!1,style:{stroke:"#fee715",strokeWidth:2},markerStart:void 0,markerEnd:{type:f.MarkerType.ArrowClosed,color:"#fee715",orient:"auto"},data:{notes:"",link:""}};aX(a=>(0,f.addEdge)(b,a))},[aX,bz]),bN=(0,c.useCallback)(a=>{a.preventDefault(),a.dataTransfer.dropEffect="move"},[]),bO=(0,c.useCallback)(a=>{let b;if(a.preventDefault(),!bf||!a0.current)return;let c=a0.current.getBoundingClientRect(),d=a.dataTransfer.getData("application/reactflow");if(!d)return;let e=JSON.parse(d),f=bf.screenToFlowPosition({x:a.clientX-c.left,y:a.clientY-c.top});b="text"===e.type?{id:`text-node-${Date.now()}`,type:"text",position:f,data:{text:"Kliknij, aby edytowaƒá",fontSize:18,fontWeight:"bold",textAlign:"left",verticalAlign:"middle",showHandles:!1,width:250,height:100},style:{width:250,height:100}}:{id:`node-${Date.now()}`,type:e.type||"custom",position:f,data:{label:e.isCustom?"W≈Çasny element":e.label,icon:e.icon,color:e.color||"#fee71520",notes:"",category:e.category}},bz(),aU(a=>a.concat(b))},[bf,aU,bz]),bP=(0,c.useRef)(!1),bQ=(0,c.useCallback)((a,b)=>{if(ax){a.preventDefault(),a.stopPropagation(),aM({type:"node",id:b.id});return}if("select"===as){if(bP.current){bP.current=!1;return}a.preventDefault(),a.stopPropagation(),bx.current=new Set(aT.filter(a=>a.selected).map(a=>a.id)),bv.current=!0;let c=b.selected;bw.current={nodeId:b.id,shouldSelect:!c},aU(a=>a.map(a=>a.id===b.id?{...a,selected:!c}:a)),setTimeout(()=>{bv.current=!1,bw.current=null,bx.current=new Set},150),c&&M?.id===b.id&&(N(null),P(!1));return}if(N(b),Z(null),P(!0),"text"===b.type){let a={text:b.data.text||"",fontSize:b.data.fontSize||18,fontWeight:b.data.fontWeight||"bold",textAlign:b.data.textAlign||"left",verticalAlign:b.data.verticalAlign||"middle",showHandles:b.data.showHandles??!1,isPinned:b.data.isPinned??!1};X(a),a7.current=JSON.parse(JSON.stringify(a)),bc(!1)}else{let a={label:b.data.label||"",icon:b.data.icon||"FileText",notes:b.data.notes||"",link:b.data.link||"",isPinned:b.data.isPinned??!1,category:b.data.category};T(a),a6.current=JSON.parse(JSON.stringify(a)),ba(!1);let c=b.data.customFields;c&&c.length>0?V(c):s?bG(b.id,s):V([])}ad(!1)},[as,M,aU,s,bG]),bR=(0,c.useCallback)((a,b)=>{if(a.stopPropagation(),ax)return void aM({type:"edge",id:b.id});Z(b),N(null);let c={notes:b.data?.notes||"",link:b.data?.link||""};_(c),a8.current=JSON.parse(JSON.stringify(c)),be(!1),ad(!0),P(!1),s&&bI(b.id,s)},[ax,s,bI]),bS=(0,c.useCallback)(a=>{if(ax&&bf){let b=bf.screenToFlowPosition({x:a.clientX,y:a.clientY});aM({type:"region",coords:{x:b.x,y:b.y,width:50,height:50}});return}"select"===as&&(aU(a=>a.map(a=>({...a,selected:!1}))),aX(a=>a.map(a=>({...a,selected:!1}))),N(null),Z(null),P(!1),ad(!1))},[ax,as,bf,aU,aX]),bT=(0,c.useCallback)(a=>{},[]),bU=(0,c.useCallback)(a=>{if(a.some(a=>"remove"===a.type)&&bz(),"select"===as){let b=a.filter(a=>"select"===a.type);if(bv.current&&b.length>0){let b=a.filter(a=>"select"!==a.type);b.length>0&&aV(b);return}if(b.length>1){bv.current=!1,bw.current=null,bx.current=new Set;let c=a.filter(a=>"select"!==a.type);c.length>0&&aV(c),aU(a=>a.map(a=>{let c=b.find(b=>"id"in b&&b.id===a.id);return c&&"selected"in c?{...a,selected:c.selected}:a}));return}}aV(a)},[as,aV,bz,aU]),bV=(0,c.useCallback)(a=>{a.some(a=>"remove"===a.type)&&bz(),aY(a)},[aY,bz]);(0,c.useEffect)(()=>{if("select"!==as||by.current||!bv.current||!bw.current)return;let a=bw.current,b=bx.current,c=new Set(aT.filter(a=>a.selected).map(a=>a.id)),d=aT.find(b=>b.id===a.nodeId);(d&&d.selected!==a.shouldSelect||b.size>0&&Array.from(b).some(b=>b!==a.nodeId&&!c.has(b)))&&(by.current=!0,aU(c=>c.map(c=>c.id===a.nodeId?{...c,selected:a.shouldSelect}:b.has(c.id)?{...c,selected:!0}:c)),setTimeout(()=>{by.current=!1},50))},[aT,as,aU]),(0,c.useEffect)(()=>{M&&"text"===M.type&&O&&aU(a=>a.map(a=>a.id===M.id?{...a,data:{...a.data,...W}}:a))},[W,M,O,aU]);let bW=(0,c.useRef)(aT);(0,c.useEffect)(()=>{aT.some((a,b)=>{if("text"===a.type){let c=bW.current[b];if(!c||c.id!==a.id)return!1;let d=a.width!==c.width,e=a.height!==c.height;if(d||e)return!0}return!1})&&aU(a=>a.map(a=>{if("text"===a.type&&(a.width||a.height)){let b=a.width||a.data.width,c=a.height||a.data.height;if(b!==a.data.width||c!==a.data.height)return{...a,data:{...a.data,width:b,height:c}}}return a})),bW.current=aT},[aT,aU]),(0,c.useEffect)(()=>{if(!M){ba(!1),bc(!1);return}if("text"===M.type){if(!a7.current)return void bc(!1);bc(JSON.stringify(W)!==JSON.stringify(a7.current))}else{if(!a6.current)return void ba(!1);ba(JSON.stringify(S)!==JSON.stringify(a6.current))}},[S,W,M]),(0,c.useEffect)(()=>{Y&&a8.current?be(JSON.stringify($)!==JSON.stringify(a8.current)):be(!1)},[$,Y]);let bX=async()=>{if(!M||!s)return;bz();let a=("text"===M.type?W.isPinned:S.isPinned)===!0;if(aU(b=>b.map(b=>{if(b.id===M.id)if("text"===b.type)return{...b,data:{...b.data,...W}};else return{...b,data:{...b.data,...S,customFields:U.length>0?U:void 0}};return a?{...b,data:{...b.data,isPinned:!1}}:b})),"custom"===M.type)try{await bH(M.id,s,U)}catch(a){console.error("B≈ÇƒÖd zapisywania customowych p√≥l:",a)}"text"===M.type?(a7.current=JSON.parse(JSON.stringify(W)),bc(!1)):(a6.current=JSON.parse(JSON.stringify(S)),ba(!1)),N(null),P(!1)},bY=()=>{M&&(bz(),aU(a=>a.filter(a=>a.id!==M.id)),aX(a=>a.filter(a=>a.source!==M.id&&a.target!==M.id)),N(null),P(!1))},bZ=async()=>{if(Y&&s){bz();try{await bJ(Y.id,s,aa)}catch(a){console.error("B≈ÇƒÖd zapisywania customowych p√≥l dla edge:",a)}aX(a=>a.map(a=>a.id===Y.id?{...a,data:{...a.data,...$,customFields:aa.length>0?aa:void 0},label:$.notes?$.notes:void 0}:a)),Z(null),ad(!1)}},b$=(0,c.useCallback)(a=>({width:a.width||a.measured?.width||150,height:a.height||a.measured?.height||80}),[]),b_=a=>{let b=aT.filter(a=>a.selected);if(b.length<2)return void aw({isOpen:!0,title:"Wymagane zaznaczenie",message:"Zaznacz co najmniej 2 elementy (Ctrl+Click lub przeciƒÖgnij myszkƒÖ), aby je wyr√≥wnaƒá.",type:"info"});let c=[...aT];if("left"===a){let a=Math.min(...b.map(a=>a.position.x));c=c.map(c=>b.find(a=>a.id===c.id)?{...c,position:{...c.position,x:a}}:c)}else if("right"===a){let a=Math.max(...b.map(a=>{let b=b$(a);return a.position.x+b.width}));c=c.map(c=>{if(b.find(a=>a.id===c.id)){let b=b$(c);return{...c,position:{...c.position,x:a-b.width}}}return c})}else if("top"===a){let a=Math.min(...b.map(a=>a.position.y));c=c.map(c=>b.find(a=>a.id===c.id)?{...c,position:{...c.position,y:a}}:c)}else if("bottom"===a){let a=Math.max(...b.map(a=>{let b=b$(a);return a.position.y+b.height}));c=c.map(c=>{if(b.find(a=>a.id===c.id)){let b=b$(c);return{...c,position:{...c.position,y:a-b.height}}}return c})}else if("center-x"===a){let a=b.reduce((a,b)=>{let c=b$(b);return a+b.position.x+c.width/2},0)/b.length;c=c.map(c=>{if(b.find(a=>a.id===c.id)){let b=b$(c);return{...c,position:{...c.position,x:a-b.width/2}}}return c})}else if("center-y"===a){let a=b.reduce((a,b)=>{let c=b$(b);return a+b.position.y+c.height/2},0)/b.length;c=c.map(c=>{if(b.find(a=>a.id===c.id)){let b=b$(c);return{...c,position:{...c.position,y:a-b.height/2}}}return c})}else if("distribute-x"===a){let a=[...b].sort((a,b)=>a.position.x-b.position.x);b$(a[0]);let d=b$(a[a.length-1]),e=(a[a.length-1].position.x+d.width-a[0].position.x)/(a.length-1);a.forEach((b,d)=>{if(d>0&&d<a.length-1){let f=c.findIndex(a=>a.id===b.id);-1!==f&&(c[f]={...c[f],position:{...c[f].position,x:a[0].position.x+e*d}})}})}else if("distribute-y"===a){let a=[...b].sort((a,b)=>a.position.y-b.position.y);b$(a[0]);let d=b$(a[a.length-1]),e=(a[a.length-1].position.y+d.height-a[0].position.y)/(a.length-1);a.forEach((b,d)=>{if(d>0&&d<a.length-1){let f=c.findIndex(a=>a.id===b.id);-1!==f&&(c[f]={...c[f],position:{...c[f].position,y:a[0].position.y+e*d}})}})}bz(),aU(c)},b0=[...aK,...Q].reduce((a,b)=>(a[b.category]||(a[b.category]=[]),a[b.category].push(b),a),{});return(Object.keys(b0).forEach(a=>{b0[a].sort((a,b)=>"Inne"===a.label?1:"Inne"===b.label?-1:0)}),y||!d)?(0,b.jsx)(l.LoadingState,{variant:"fullscreen",label:"≈Åadowanie lejka‚Ä¶"}):w?(0,b.jsxs)("div",{className:"h-screen bg-[#101820] flex flex-col relative",children:[!ak&&(0,b.jsx)("button",{onClick:()=>al(!0),className:"fixed top-2 left-2 z-50 p-2 bg-[#18232F]/95 border border-[#fee715]/30 text-[#fee715] rounded-lg hover:bg-[#fee715]/10 hover:border-[#fee715]/50 transition-all duration-200 shadow-lg backdrop-blur-sm",title:"Poka≈º nag≈Ç√≥wek",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,b.jsxs)("div",{className:`flex items-center justify-between px-6 py-4 border-b border-white/10 bg-[#18232F] transition-all duration-300 ${ak?"opacity-100":"opacity-0 h-0 overflow-hidden border-0"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:()=>v.push("/admin/marketing"),className:"p-2 hover:bg-white/10 rounded-lg transition-all",children:(0,b.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),(0,b.jsxs)("div",{className:"flex-1",children:[C?(0,b.jsx)("input",{type:"text",value:G,onChange:a=>H(a.target.value),onBlur:async()=>{if(D(!1),G!==w.project_name&&w)try{let{error:a}=await j.supabase.from("funnel_diagrams").update({project_name:G}).eq("id",w.id);if(a)throw a;x({...w,project_name:G})}catch(a){console.error("B≈ÇƒÖd zapisywania tytu≈Çu:",a),H(w.project_name||"")}},onKeyDown:a=>{"Enter"===a.key&&a.currentTarget.blur(),"Escape"===a.key&&(H(w.project_name||""),D(!1))},className:"font-[Montserrat] text-xl font-bold text-white bg-white/10 border border-[#fee715]/50 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 w-full max-w-md",autoFocus:!0}):(0,b.jsxs)("h1",{className:"font-[Montserrat] text-xl font-bold text-white cursor-pointer hover:text-[#fee715] transition-colors",onClick:()=>{D(!0),H(w.project_name||"")},title:"Kliknij, aby edytowaƒá tytu≈Ç",children:["Mapa marketingu - ",w.project_name||"Bez nazwy"]}),E?(0,b.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:["select"===K?(0,b.jsx)(m.CustomSelect,{value:I||"",onChange:async a=>{if("custom"===a)L("custom"),J("");else if(J(a),w&&a!==w.subtitle)try{let{error:b}=await j.supabase.from("funnel_diagrams").update({subtitle:a}).eq("id",w.id);if(b)throw b;x({...w,subtitle:a}),F(!1)}catch(a){console.error("B≈ÇƒÖd zapisywania podtytu≈Çu:",a)}else F(!1)},options:[{value:"stan obecny",label:"stan obecny"},{value:"docelowy",label:"docelowy"},{value:"Plan 90 dni",label:"Plan 90 dni"},{value:"custom",label:"W≈Çasny tekst..."}],placeholder:"Wybierz podtytu≈Ç",className:"w-48",size:"sm"}):(0,b.jsx)("input",{type:"text",value:I,onChange:a=>J(a.target.value),placeholder:"Wpisz w≈Çasny podtytu≈Ç",className:"text-sm bg-white/10 border border-[#fee715]/50 rounded px-2 py-1 text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 w-48",autoFocus:!0}),(0,b.jsx)("button",{onClick:async()=>{if(w){let a=I.trim()||null;try{let{error:b}=await j.supabase.from("funnel_diagrams").update({subtitle:a}).eq("id",w.id);if(b)throw b;x({...w,subtitle:a}),a&&["stan obecny","docelowy","Plan 90 dni"].includes(a)&&L("select"),F(!1)}catch(a){console.error("B≈ÇƒÖd zapisywania podtytu≈Çu:",a),J(w.subtitle||""),F(!1)}}else F(!1)},className:"px-2 py-1 text-xs bg-[#fee715]/10 border border-[#fee715]/50 text-[#fee715] rounded hover:bg-[#fee715]/20 transition-colors",children:"‚úì"}),(0,b.jsx)("button",{onClick:()=>{J(w.subtitle||""),F(!1),w.subtitle&&["stan obecny","docelowy","Plan 90 dni"].includes(w.subtitle)?L("select"):w.subtitle&&L("custom")},className:"px-2 py-1 text-xs bg-white/10 border border-white/20 text-white/70 rounded hover:bg-white/20 transition-colors",title:"Anuluj",children:"√ó"})]}):(0,b.jsx)("div",{className:"inline-flex items-center px-3 py-1 rounded-md bg-white/[0.04] border border-white/10 text-xs font-medium text-gray-300 cursor-pointer hover:bg-white/[0.06] hover:border-white/20 hover:text-white transition-all mt-0.5",onClick:()=>{F(!0),J(w.subtitle||""),w.subtitle&&["stan obecny","docelowy","Plan 90 dni"].includes(w.subtitle)?L("select"):L("custom")},title:"Kliknij, aby edytowaƒá podtytu≈Ç",children:w.subtitle||"Kliknij, aby dodaƒá podtytu≈Ç"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{onClick:()=>al(!1),className:"p-1.5 hover:bg-white/10 rounded-lg transition-all text-gray-400 hover:text-white",title:"Ukryj nag≈Ç√≥wek",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),A&&u?.email==="stanislaw@drozniak.com"&&(0,b.jsxs)("span",{className:"text-sm text-gray-400 flex items-center gap-2",children:[(0,b.jsx)("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Zapisujƒô..."]}),(0,b.jsx)("button",{onClick:bA,disabled:0===a$.length,title:"Cofnij ostatniƒÖ zmianƒô (Ctrl+Z)",className:"px-4 py-2 bg-white/[0.06] border border-white/20 text-white/90 rounded-lg font-medium hover:bg-white/10 hover:border-white/30 transition-colors disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-white/[0.06] disabled:hover:border-white/20",children:"Wstecz"}),(0,b.jsxs)("button",{onClick:()=>{aA(!az),az||bC()},className:`px-4 py-2 rounded-lg font-medium transition-colors ${az?"bg-[#fee715]/10 border border-[#fee715]/50 text-[#fee715]":"bg-white/[0.06] border border-white/20 text-white/90 hover:bg-white/10"}`,title:"Komentarze",children:[(0,b.jsx)(aD.ChatCircleDots,{size:18,className:"inline-block mr-1.5"}),"Komentarze"]}),(0,b.jsx)("button",{onClick:bL,className:"relative px-5 py-2 bg-[#fee715]/10 border border-[#fee715]/50 text-[#fee715] rounded-lg font-medium hover:bg-[#fee715]/20 hover:border-[#fee715]/70 transition-all duration-200",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:["Zapisz zmiany",a4&&(0,b.jsx)("span",{className:"w-2 h-2 bg-[#fee715] rounded-full animate-pulse",title:"Masz niezapisane zmiany"})]})})]})]}),!am&&(0,b.jsx)("button",{onClick:()=>an(!0),className:`fixed z-50 p-2 bg-[#0a0f14]/95 border border-[#fee715]/30 text-[#fee715] rounded-lg hover:bg-[#fee715]/10 hover:border-[#fee715]/50 transition-all duration-200 shadow-lg backdrop-blur-sm ${!ak?"top-14 left-2":"top-2 left-2"}`,title:"Poka≈º panel element√≥w",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,b.jsxs)("div",{className:"flex-1 flex overflow-hidden relative",children:[(0,b.jsx)("div",{className:`transition-all duration-300 overflow-hidden funnel-builder-sidebar ${am?"w-64 opacity-100":"w-0 opacity-0"}`,style:{backgroundColor:"#0a0f14",background:"#0a0f14"},children:(0,b.jsxs)("div",{className:"w-64 h-full border-r-2 border-[#fee715]/30 overflow-y-auto p-4 shadow-2xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"font-[Montserrat] font-medium text-[#fee715] text-base tracking-tight border-b border-[#fee715]/20 pb-2.5 flex-1",children:"Elementy"}),(0,b.jsx)("button",{onClick:()=>an(!1),className:"p-1.5 hover:bg-white/10 rounded-lg transition-all text-gray-400 hover:text-white ml-2",title:"Ukryj panel element√≥w",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsx)("div",{className:"space-y-6",children:Object.entries(b0).map(([a,c])=>(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-xs font-medium text-[#fee715] uppercase mb-3 tracking-wider px-2",children:a}),(0,b.jsx)("div",{className:"space-y-2",children:c.map((a,c)=>(0,b.jsx)("div",{draggable:!0,onDragStart:b=>{b.dataTransfer.setData("application/reactflow",JSON.stringify(a))},className:"p-3 bg-[#18232F]/90 rounded-lg border border-white/10 hover:border-[#fee715]/40 cursor-move transition-all duration-200 shadow-sm hover:shadow-lg hover:shadow-[#fee715]/10 backdrop-blur-sm relative overflow-hidden group",style:{background:"linear-gradient(to bottom, rgba(24, 35, 47, 0.9), rgba(24, 35, 47, 0.9))"},onMouseEnter:a=>{a.currentTarget.style.background="linear-gradient(135deg, rgba(254, 231, 21, 0.08) 0%, rgba(24, 35, 47, 0.95) 50%, rgba(254, 231, 21, 0.05) 100%)"},onMouseLeave:a=>{a.currentTarget.style.background="linear-gradient(to bottom, rgba(24, 35, 47, 0.9), rgba(24, 35, 47, 0.9))"},children:(0,b.jsxs)("div",{className:"flex items-center gap-2 relative z-10",children:[(0,b.jsx)("div",{className:"text-white",children:aH(a.icon,18)}),(0,b.jsx)("span",{className:"text-sm text-white/95 font-medium tracking-tight",children:a.label})]})},c))})]},a))})]})}),(0,b.jsxs)("div",{className:"flex-1 relative",ref:a0,children:[aq&&(0,b.jsxs)("div",{className:"absolute top-4 right-4 z-20 bg-[#0a0f14]/98 border border-white/10 rounded-lg shadow-xl backdrop-blur-sm p-4 min-w-[200px]",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"text-xs font-medium text-white/90 tracking-tight",children:"Legenda"}),(0,b.jsx)("button",{onClick:()=>ar(!1),className:"p-1 hover:bg-white/10 rounded transition-all text-gray-400 hover:text-white",title:"Ukryj legendƒô",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,b.jsxs)("div",{className:"relative shrink-0 mt-0.5",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center text-white",style:{backgroundColor:"#4285F420"},children:aH("MegaphoneSimple",14)}),(0,b.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-[#0a0f14]",style:{backgroundColor:"#4285F4"}})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-white/90 font-medium",children:"≈πr√≥d≈Ça Ruchu"}),(0,b.jsx)("div",{className:"text-white/50 text-[10px] mt-0.5",children:"Facebook Ads, Google Ads, Email"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,b.jsxs)("div",{className:"relative shrink-0 mt-0.5",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center text-white",style:{backgroundColor:"#00C9A720"},children:aH("Globe",14)}),(0,b.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-[#0a0f14]",style:{backgroundColor:"#00C9A7"}})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-white/90 font-medium",children:"Typ Strony"}),(0,b.jsx)("div",{className:"text-white/50 text-[10px] mt-0.5",children:"Landing, Sprzeda≈ºowa, Checkout"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,b.jsxs)("div",{className:"relative shrink-0 mt-0.5",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center text-white",style:{backgroundColor:"#fee71520"},children:aH("Notebook",14)}),(0,b.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-[#0a0f14]",style:{backgroundColor:"#fee715"}})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-white/90 font-medium",children:"Dzia≈Çania"}),(0,b.jsx)("div",{className:"text-white/50 text-[10px] mt-0.5",children:"Lead magnet, Webinar, Chatbot"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,b.jsxs)("div",{className:"relative shrink-0 mt-0.5",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center text-white",style:{backgroundColor:"#10B98120"},children:aH("CheckCircle",14)}),(0,b.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-[#0a0f14]",style:{backgroundColor:"#10B981"}})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-white/90 font-medium",children:"Cel/Konwersja"}),(0,b.jsx)("div",{className:"text-white/50 text-[10px] mt-0.5",children:"Lead, Rezerwacja, Telefon, Sprzeda≈º"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2.5",children:[(0,b.jsx)("div",{className:"relative shrink-0 mt-0.5",children:(0,b.jsx)("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center text-white bg-white/5 border border-white/10",children:aH("FileText",14)})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"text-white/90 font-medium",children:"Narzƒôdzia"}),(0,b.jsx)("div",{className:"text-white/50 text-[10px] mt-0.5",children:"Pola tekstowe, notatki"})]})]})]})]}),!aq&&(0,b.jsx)("button",{onClick:()=>ar(!0),className:"absolute top-4 right-4 z-20 p-2 bg-[#0a0f14]/95 border border-white/10 text-white/70 rounded-lg hover:bg-white/10 hover:text-white transition-all duration-200 shadow-lg backdrop-blur-sm",title:"Poka≈º legendƒô",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,b.jsx)(aF.Provider,{value:{isSelectMode:"select"===as,onLongPressDeselect:bT},children:(0,b.jsxs)(e.ReactFlow,{nodes:aT.map(a=>{let b=aN.get(a.id);if(b&&b.count>0){let c={...a,data:{...a.data,commentCount:b.count,commentStatus:b.status}};return a.id===aT[0]?.id&&console.log("Przyk≈Çadowy node z komentarzami:",{nodeId:c.id,commentCount:c.data.commentCount,commentStatus:c.data.commentStatus,hasBadge:void 0!==c.data.commentCount&&c.data.commentCount>0}),c}return{...a,data:{...a.data,commentCount:void 0,commentStatus:void 0}}}),edges:aW.map(a=>{let b=aP.get(a.id);return b&&b.count>0?{...a,data:{...a.data,commentCount:b.count,commentStatus:b.status}}:{...a,data:{...a.data,commentCount:void 0,commentStatus:void 0}}}),onNodesChange:bU,onEdgesChange:bV,onConnect:bM,onNodeDragStart:(a,b)=>{bP.current=!0,bz()},isValidConnection:()=>!0,onInit:bg,onDrop:bO,onDragOver:bN,onNodeClick:bQ,onEdgeClick:bR,onPaneClick:bS,onSelectionChange:a=>{if("select"===as&&bv.current)return},onViewportChange:a=>{bs(a),bo(a.zoom)},onNodeDrag:(a,b,c)=>{let d=c.filter(a=>a.id!==b.id);if(0===d.length)return void bq({vertical:[],horizontal:[]});let e=b$(b),f=b.position.x,g=b.position.x+e.width/2,h=b.position.x+e.width,i=b.position.y,j=b.position.y+e.height/2,k=b.position.y+e.height,l=new Set,m=new Set;d.forEach(a=>{let b=b$(a),c=a.position.x,d=a.position.x+b.width/2,e=a.position.x+b.width,n=a.position.y,o=a.position.y+b.height/2,p=a.position.y+b.height;(5>=Math.abs(f-c)||5>=Math.abs(g-c)||5>=Math.abs(h-c))&&l.add(c),(5>=Math.abs(f-d)||5>=Math.abs(g-d)||5>=Math.abs(h-d))&&l.add(d),(5>=Math.abs(f-e)||5>=Math.abs(g-e)||5>=Math.abs(h-e))&&l.add(e),(5>=Math.abs(i-n)||5>=Math.abs(j-n)||5>=Math.abs(k-n))&&m.add(n),(5>=Math.abs(i-o)||5>=Math.abs(j-o)||5>=Math.abs(k-o))&&m.add(o),(5>=Math.abs(i-p)||5>=Math.abs(j-p)||5>=Math.abs(k-p))&&m.add(p)}),bq({vertical:Array.from(l),horizontal:Array.from(m)})},onNodeDragStop:(a,b)=>{let c=b$(b),d=b.position.x,e=b.position.y;for(let a of bp.vertical){let e=Math.abs(b.position.x-a),f=Math.abs(b.position.x+c.width/2-a),g=Math.abs(b.position.x+c.width-a);if(e<=5){d=a;break}if(f<=5){d=a-c.width/2;break}if(g<=5){d=a-c.width;break}}for(let a of bp.horizontal){let d=Math.abs(b.position.y-a),f=Math.abs(b.position.y+c.height/2-a),g=Math.abs(b.position.y+c.height-a);if(d<=5){e=a;break}if(f<=5){e=a-c.height/2;break}if(g<=5){e=a-c.height;break}}(d!==b.position.x||e!==b.position.y)&&aU(a=>a.map(a=>a.id===b.id?{...a,position:{x:d,y:e}}:a)),bq({vertical:[],horizontal:[]})},nodeTypes:aI,edgeTypes:aJ,fitView:!0,fitViewOptions:{padding:.2,duration:0},className:`bg-[#101820] ${"select"===as?"funnel-select-mode":""}`,connectionLineType:"smoothstep",snapToGrid:!0,snapGrid:[20,20],connectionLineStyle:{stroke:"#fee715",strokeWidth:2,strokeDasharray:"5,5"},defaultEdgeOptions:{type:"custom",animated:!1,style:{stroke:"#fee715",strokeWidth:2},markerStart:void 0,markerEnd:{type:f.MarkerType.ArrowClosed,color:"#fee715",orient:"auto"}},nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,elementsSelectable:"select"!==as,selectNodesOnDrag:!1,panOnDrag:"pan"===as||!!bl&&[1,2],panOnScroll:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!1,preventScrolling:!1,selectionOnDrag:"select"===as,selectionMode:"full",multiSelectionKeyCode:null,deleteKeyCode:["Delete","Backspace"],connectionMode:"loose",connectionRadius:80,minZoom:.01,maxZoom:10,proOptions:{hideAttribution:!0},children:[(0,b.jsx)(e.Background,{variant:e.BackgroundVariant.Dots,gap:20,size:1.5,color:"#ffffff25",style:{opacity:.6}}),!ao&&(0,b.jsx)(e.Panel,{position:"bottom-left",children:(0,b.jsx)("button",{onClick:()=>ap(!0),className:"p-2 bg-[#0a0f14]/95 border border-[#fee715]/30 text-[#fee715] rounded-lg hover:bg-[#fee715]/10 hover:border-[#fee715]/50 transition-all duration-200 shadow-lg backdrop-blur-sm",title:"Poka≈º narzƒôdzia",children:(0,b.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),ao&&(0,b.jsx)(e.Panel,{position:"bottom-left",className:"bg-[#0a0f14]/95 border border-amber-500/20 rounded-lg p-2 shadow-xl backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>ap(!1),className:"p-1.5 hover:bg-white/10 rounded-lg transition-all text-gray-400 hover:text-white",title:"Ukryj narzƒôdzia",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,b.jsxs)("div",{className:"flex items-center gap-1 border-r border-[#fee715]/20 pr-2 mr-2",children:[(0,b.jsx)("span",{className:"text-xs text-amber-400/90 font-medium mr-1",children:"Tryb:"}),(0,b.jsx)("button",{onClick:()=>at("pan"),className:`p-2 rounded-lg transition-all duration-200 ${"pan"===as?"bg-gradient-to-r from-amber-600 to-amber-500 text-white shadow-md shadow-amber-900/20":"bg-[#18232F]/80 text-white/80 hover:bg-amber-500/10 hover:text-white border border-white/10 hover:border-amber-500/50 backdrop-blur-sm"}`,title:"Przesuwanie (Space + drag lub ≈õrodkowy przycisk myszy)",children:(0,b.jsx)(aE.Hand,{size:16})}),(0,b.jsx)("button",{onClick:()=>at("select"),className:`p-2 rounded-lg transition-all duration-200 ${"select"===as?"bg-gradient-to-r from-amber-600 to-amber-500 text-white shadow-md shadow-amber-900/20":"bg-[#18232F]/80 text-white/80 hover:bg-amber-500/10 hover:text-white border border-white/10 hover:border-amber-500/50 backdrop-blur-sm"}`,title:"Zaznaczanie element√≥w: Klikaj elementy lub przeciƒÖgnij po pustym tle (box selection)",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})})}),(0,b.jsx)("button",{onClick:()=>{ay(!ax),at(ax?"pan":"comment")},className:`p-2 rounded-lg transition-all duration-200 ${ax?"bg-gradient-to-r from-amber-600 to-amber-500 text-white shadow-md shadow-amber-900/20":"bg-[#18232F]/80 text-white/80 hover:bg-amber-500/10 hover:text-white border border-white/10 hover:border-amber-500/50 backdrop-blur-sm"}`,title:"Dodaj komentarz (kliknij na element)",children:(0,b.jsx)(aD.ChatCircleDots,{size:16})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("button",{onClick:()=>bf?.zoomOut({duration:300}),className:"p-2 bg-[#18232F]/80 border border-white/10 hover:border-amber-500/50 hover:bg-amber-500/10 rounded-lg transition-all duration-200 text-white/80 hover:text-white backdrop-blur-sm",title:"Oddal (Zoom Out)",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"})})}),(0,b.jsx)("button",{onClick:()=>bf?.zoomIn({duration:300}),className:"p-2 bg-[#18232F]/80 border border-white/10 hover:border-amber-500/50 hover:bg-amber-500/10 rounded-lg transition-all duration-200 text-white/80 hover:text-white backdrop-blur-sm",title:"Przybli≈º (Zoom In)",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7"})})}),(0,b.jsx)("button",{onClick:()=>bf?.fitView({duration:300,padding:.2}),className:"p-2 bg-[#18232F]/80 border border-white/10 hover:border-amber-500/50 hover:bg-amber-500/10 rounded-lg transition-all duration-200 text-white/80 hover:text-white backdrop-blur-sm",title:"Dopasuj do widoku (Fit View)",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),(0,b.jsxs)("div",{className:"px-2 text-xs text-amber-400/90 font-medium border-l border-amber-500/20 ml-2 pl-2",children:[(100*bn).toFixed(0),"%"]})]})]})}),ae&&(0,b.jsx)("div",{className:"absolute bottom-4 right-4 z-10",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("button",{onClick:()=>af(!1),className:"absolute -top-2 -right-2 z-20 w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs font-bold shadow-lg transition-all",title:"Zamknij podglƒÖd",children:"√ó"}),(0,b.jsx)(e.MiniMap,{className:"bg-[#18232F] border-2 border-[#fee715] rounded-lg shadow-2xl",nodeColor:"#fee715",nodeStrokeColor:"#101820",nodeStrokeWidth:2,maskColor:"rgba(16, 24, 32, 0.9)",style:{backgroundColor:"#18232F"},pannable:!0,zoomable:!0})]})}),!ae&&(0,b.jsx)("button",{onClick:()=>af(!0),className:"absolute bottom-4 right-4 z-10 px-4 py-2 bg-[#fee715]/10 border border-[#fee715]/40 text-[#fee715] rounded-lg font-medium hover:bg-[#fee715]/20 hover:border-[#fee715]/60 transition-all duration-200",title:"Poka≈º podglƒÖd",children:"‚Üë PodglƒÖd"}),ai&&(0,b.jsx)(e.Panel,{position:"top-center",className:"bg-transparent",children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5 bg-[#0a0f14]/95 border border-white/10 rounded-lg p-1.5 shadow-xl backdrop-blur-sm",children:[(0,b.jsx)("button",{onClick:()=>b_("center-y"),className:"p-1.5 bg-[#18232F]/80 border border-white/10 hover:border-[#fee715]/50 hover:bg-[#fee715]/10 rounded transition-all duration-200 text-white/80 hover:text-white",title:"Wyr√≥wnaj w pionie (ta sama wysoko≈õƒá Y)",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12h16M4 12l4-4m-4 4l4 4m12-4l-4-4m4 4l-4 4"})})}),(0,b.jsx)("button",{onClick:()=>b_("center-x"),className:"p-1.5 bg-[#18232F]/80 border border-white/10 hover:border-[#fee715]/50 hover:bg-[#fee715]/10 rounded transition-all duration-200 text-white/80 hover:text-white",title:"Wyr√≥wnaj w poziomie (ta sama pozycja X)",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16M12 4l-4 4m4-4l4 4m-4 12l-4-4m4 4l4-4"})})}),(0,b.jsx)("div",{className:"w-px h-4 bg-white/10 mx-0.5"}),(0,b.jsx)("button",{onClick:()=>aj(!1),className:"p-1.5 bg-[#18232F]/80 border border-white/10 hover:border-white/30 hover:bg-white/10 rounded transition-all duration-200 text-white/60 hover:text-white",title:"Ukryj panel",children:(0,b.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),!ai&&(0,b.jsx)(e.Panel,{position:"top-center",className:"bg-transparent",children:(0,b.jsx)("button",{onClick:()=>aj(!0),className:"p-2 bg-[#0a0f14]/95 border border-white/10 text-white/60 rounded-lg hover:bg-white/10 hover:text-white hover:border-white/20 transition-all duration-200 shadow-lg backdrop-blur-sm",title:"Poka≈º wyr√≥wnywanie",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]})}),(bp.vertical.length>0||bp.horizontal.length>0)&&bt.w>0&&bt.h>0&&(0,b.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:10},children:(0,b.jsxs)("svg",{width:"100%",height:"100%",viewBox:`0 0 ${bt.w} ${bt.h}`,preserveAspectRatio:"none",children:[bp.vertical.map(a=>{let c=a*br.zoom+br.x;return(0,b.jsx)("line",{x1:c,y1:0,x2:c,y2:bt.h,stroke:"#fee715",strokeOpacity:.8,strokeWidth:1},`v-${a}`)}),bp.horizontal.map(a=>{let c=a*br.zoom+br.y;return(0,b.jsx)("line",{x1:0,y1:c,x2:bt.w,y2:c,stroke:"#fee715",strokeOpacity:.8,strokeWidth:1},`h-${a}`)})]})})]}),ac&&Y&&(0,b.jsxs)("div",{className:"w-72 border-l border-white/10 p-4 overflow-y-auto bg-[#0a0f14]/98 nodrag nopan",onKeyDown:a=>{["INPUT","TEXTAREA","SELECT"].includes(a.target?.tagName)&&a.stopPropagation()},onKeyUp:a=>{["INPUT","TEXTAREA","SELECT"].includes(a.target?.tagName)&&a.stopPropagation()},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"font-medium text-white text-sm tracking-tight",children:"W≈Ça≈õciwo≈õci linii"}),(0,b.jsx)("button",{onClick:()=>{ad(!1),Z(null)},className:"p-0.5 hover:bg-white/5 rounded text-gray-500 hover:text-gray-300 transition-colors",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Notatki"}),(0,b.jsx)("textarea",{value:$.notes,onChange:a=>_({...$,notes:a.target.value}),className:"w-full bg-white/[0.04] border border-white/10 rounded px-3 py-1.5 text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30 min-h-[72px]",placeholder:"Notatki do linii..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Link (opcjonalnie)"}),(0,b.jsx)("input",{type:"url",value:$.link,onChange:a=>_({...$,link:a.target.value}),className:"w-full bg-white/[0.04] border border-white/10 rounded px-3 py-1.5 text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30",placeholder:"https://..."})]}),(0,b.jsxs)("div",{className:"pt-3 mt-3 border-t border-white/10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400",children:"Dodatkowe pola"}),(0,b.jsx)("button",{onClick:()=>{ab([...aa,{field_name:"",field_type:"text",field_value:"",display_order:aa.length}])},className:"px-2 py-1 text-xs bg-white/[0.06] border border-white/20 text-white/90 rounded hover:bg-white/10 hover:border-white/30 transition-colors",children:"+ Dodaj pole"})]}),(0,b.jsxs)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[aa.map((a,c)=>(0,b.jsxs)("div",{className:"p-2 bg-white/[0.02] border border-white/5 rounded",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("input",{type:"text",value:a.field_name,onChange:a=>{let b=[...aa];b[c].field_name=a.target.value,ab(b)},placeholder:"Nazwa pola",className:"flex-1 bg-white/[0.04] border border-white/10 rounded px-2 py-1 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"}),(0,b.jsx)(m.CustomSelect,{size:"sm",value:a.field_type,onChange:a=>{let b=[...aa];b[c].field_type=a,b[c].field_value="",ab(b)},options:[{value:"text",label:"Tekst"},{value:"date",label:"Data"},{value:"number",label:"Liczba"},{value:"link",label:"Link"}],className:"w-24"}),(0,b.jsx)("button",{onClick:()=>{ab(aa.filter((a,b)=>b!==c))},className:"p-1 text-gray-400 hover:text-red-400 transition-colors",title:"Usu≈Ñ pole",children:(0,b.jsx)(au.Trash,{size:14})})]}),"text"===a.field_type&&(0,b.jsx)("input",{type:"text",value:a.field_value,onChange:a=>{let b=[...aa];b[c].field_value=a.target.value,ab(b)},placeholder:"Warto≈õƒá tekstowa",className:"w-full bg-white/[0.04] border border-white/10 rounded px-2 py-1 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"}),"date"===a.field_type&&(0,b.jsx)(aL,{value:a.field_value,onChange:a=>{let b=[...aa];b[c].field_value=a,ab(b)}}),"number"===a.field_type&&(0,b.jsxs)("div",{className:"relative w-full",children:[(0,b.jsx)("input",{type:"text",inputMode:"numeric",value:a.field_value,onChange:a=>{let b=a.target.value.replace(/[^0-9.-]/g,""),d=[...aa];d[c].field_value=b,ab(d)},placeholder:"Warto≈õƒá liczbowa",className:"w-full bg-white/[0.04] border border-white/10 rounded px-2 py-1 pr-12 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"}),(0,b.jsxs)("div",{className:"absolute right-0.5 top-0 bottom-0 w-11 flex flex-col",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{let b=parseFloat(a.field_value)||0,d=[...aa];d[c].field_value=String(b+1),ab(d)},className:"flex-1 flex items-center justify-center text-gray-400 hover:text-white border-b border-white/10 hover:bg-white/5 rounded-t",children:(0,b.jsx)(ag.Plus,{size:10})}),(0,b.jsx)("button",{type:"button",onClick:()=>{let b=parseFloat(a.field_value)||0,d=[...aa];d[c].field_value=String(Math.max(0,b-1)),ab(d)},className:"flex-1 flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/5 rounded-b",children:(0,b.jsx)(ah.Minus,{size:10})})]})]}),"link"===a.field_type&&(0,b.jsx)("input",{type:"url",value:a.field_value,onChange:a=>{let b=[...aa];b[c].field_value=a.target.value,ab(b)},placeholder:"https://example.com",className:"w-full bg-white/[0.04] border border-white/10 rounded px-2 py-1 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"})]},c)),0===aa.length&&(0,b.jsx)("div",{className:"text-xs text-gray-500 py-2 text-center",children:"Brak dodatkowych p√≥l"})]})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("button",{onClick:()=>{if(Y){let a=Y.target,b=Y.source;aX(c=>c.map(c=>c.id===Y.id?{...c,source:a,target:b}:c)),Z({...Y,source:a,target:b})}},className:"w-full px-3 py-1.5 bg-white/[0.04] border border-white/10 text-gray-300 rounded text-sm font-medium hover:bg-white/5 hover:border-[#fee715]/30 hover:text-[#fee715] transition-colors flex items-center justify-center gap-1.5",title:"Odwr√≥ƒá kierunek strza≈Çki",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Odwr√≥ƒá kierunek"]})}),(0,b.jsxs)("div",{className:"flex gap-2 pt-3 mt-3 border-t border-white/10",children:[(0,b.jsx)("button",{onClick:bZ,className:"relative flex-1 px-3 py-1.5 bg-[#fee715]/10 border border-[#fee715]/40 text-[#fee715] rounded text-sm font-medium hover:bg-[#fee715]/15 hover:border-[#fee715]/50 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["Zapisz zmiany",bd&&(0,b.jsx)("span",{className:"w-1.5 h-1.5 bg-[#fee715] rounded-full animate-pulse",title:"Masz niezapisane zmiany"})]})}),(0,b.jsx)("button",{onClick:()=>{Y&&(bz(),aX(a=>a.filter(a=>a.id!==Y.id)),Z(null),ad(!1))},title:"Delete / Backspace",className:"px-3 py-1.5 bg-white/[0.06] border border-white/20 text-white/90 rounded text-sm font-medium hover:bg-white/10 hover:border-white/30 transition-colors",children:"Usu≈Ñ"})]}),(0,b.jsx)("p",{className:"text-[11px] text-gray-500 mt-2",children:"Delete / Backspace ‚Äî usuwa strza≈Çkƒô."})]})]}),O&&M&&(0,b.jsxs)("div",{className:"w-72 border-l border-white/10 p-4 overflow-y-auto overflow-x-visible bg-[#0a0f14]/98 nodrag nopan",style:{zIndex:10},onKeyDown:a=>{["INPUT","TEXTAREA","SELECT"].includes(a.target?.tagName)&&a.stopPropagation()},onKeyUp:a=>{["INPUT","TEXTAREA","SELECT"].includes(a.target?.tagName)&&a.stopPropagation()},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"font-medium text-white text-sm tracking-tight",children:"text"===M.type?"W≈Ça≈õciwo≈õci tekstu":"W≈Ça≈õciwo≈õci"}),(0,b.jsx)("button",{onClick:()=>{P(!1),N(null)},className:"p-0.5 hover:bg-white/5 rounded text-gray-500 hover:text-gray-300 transition-colors",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),"text"===M.type?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Tekst"}),(0,b.jsx)("textarea",{value:W.text,onChange:a=>X({...W,text:a.target.value}),className:"w-full bg-white/[0.04] border border-white/10 rounded px-3 py-1.5 text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30 min-h-[72px]",placeholder:"Wpisz tekst..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Rozmiar czcionki"}),(0,b.jsx)("input",{type:"number",min:"10",max:"72",value:W.fontSize,onChange:a=>X({...W,fontSize:parseInt(a.target.value)||18}),className:"w-full bg-white/[0.04] border border-white/10 rounded px-3 py-1.5 text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Waga czcionki"}),(0,b.jsx)(m.CustomSelect,{size:"sm",value:W.fontWeight||"bold",onChange:a=>X({...W,fontWeight:a}),options:[{value:"normal",label:"Normal"},{value:"semibold",label:"Semibold"},{value:"bold",label:"Bold"}],className:"w-full"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Wyr√≥wnanie poziome"}),(0,b.jsx)(m.CustomSelect,{size:"sm",value:W.textAlign||"left",onChange:a=>X({...W,textAlign:a}),options:[{value:"left",label:"Lewo"},{value:"center",label:"≈örodek"},{value:"right",label:"Prawo"}],className:"w-full"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Wyr√≥wnanie pionowe"}),(0,b.jsx)(m.CustomSelect,{size:"sm",value:W.verticalAlign||"middle",onChange:a=>X({...W,verticalAlign:a}),options:[{value:"top",label:"G√≥ra"},{value:"middle",label:"≈örodek"},{value:"bottom",label:"D√≥≈Ç"}],className:"w-full"})]}),(0,b.jsx)("div",{className:"pt-0.5",children:(0,b.jsx)(n.CustomCheckbox,{id:"showHandles",checked:W.showHandles??!1,onChange:a=>X({...W,showHandles:a}),label:"Punkty po≈ÇƒÖczenia",size:"sm",labelClassName:"text-xs font-medium text-gray-400"})}),(0,b.jsxs)("div",{className:"flex gap-2 pt-3 mt-3 border-t border-white/10",children:[(0,b.jsx)("button",{onClick:bX,className:"relative flex-1 px-3 py-1.5 bg-[#fee715]/10 border border-[#fee715]/40 text-[#fee715] rounded text-sm font-medium hover:bg-[#fee715]/15 hover:border-[#fee715]/50 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["Zapisz zmiany",bb&&(0,b.jsx)("span",{className:"w-1.5 h-1.5 bg-[#fee715] rounded-full animate-pulse",title:"Masz niezapisane zmiany"})]})}),(0,b.jsx)("button",{onClick:bY,className:"px-3 py-1.5 bg-white/[0.06] border border-white/20 text-white/90 rounded text-sm font-medium hover:bg-white/10 hover:border-white/30 transition-colors",children:"Usu≈Ñ"})]})]}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Nazwa"}),(0,b.jsx)("input",{type:"text",value:S.label,onChange:a=>T({...S,label:a.target.value}),className:"w-full bg-white/[0.04] border border-white/10 rounded px-3 py-1.5 text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30",placeholder:"Nazwa elementu"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Ikona"}),(0,b.jsx)(o.IconPicker,{value:S.icon,onChange:a=>T({...S,icon:a}),className:"w-full"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Notatki"}),(0,b.jsx)("textarea",{value:S.notes,onChange:a=>T({...S,notes:a.target.value}),className:"w-full bg-white/[0.04] border border-white/10 rounded px-3 py-1.5 text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30 min-h-[72px]",placeholder:"Notatki (np. CPC: 2 PLN)"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Link"}),(0,b.jsx)("input",{type:"url",value:S.link||"",onChange:a=>T({...S,link:a.target.value}),className:"w-full bg-white/[0.04] border border-white/10 rounded px-3 py-1.5 text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30",placeholder:"https://example.com"})]}),(0,b.jsxs)("div",{className:"pt-3 mt-3 border-t border-white/10",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400",children:"Dodatkowe pola"}),(0,b.jsx)("button",{onClick:()=>{V([...U,{field_name:"",field_type:"text",field_value:"",display_order:U.length}])},className:"px-2 py-1 text-xs bg-white/[0.06] border border-white/20 text-white/90 rounded hover:bg-white/10 hover:border-white/30 transition-colors",children:"+ Dodaj pole"})]}),(0,b.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:U.map((a,c)=>(0,b.jsxs)("div",{className:"p-2 bg-white/[0.02] border border-white/5 rounded",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("input",{type:"text",value:a.field_name,onChange:a=>{let b=[...U];b[c].field_name=a.target.value,V(b)},placeholder:"Nazwa pola",className:"flex-1 bg-white/[0.04] border border-white/10 rounded px-2 py-1 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"}),(0,b.jsx)(m.CustomSelect,{size:"sm",value:a.field_type,onChange:a=>{let b=[...U];b[c].field_type=a,b[c].field_value="",V(b)},options:[{value:"text",label:"Tekst"},{value:"date",label:"Data"},{value:"number",label:"Liczba"},{value:"link",label:"Link"}],className:"w-24"})]}),"text"===a.field_type&&(0,b.jsx)("input",{type:"text",value:a.field_value,onChange:a=>{let b=[...U];b[c].field_value=a.target.value,V(b)},placeholder:"Warto≈õƒá tekstowa",className:"w-full bg-white/[0.04] border border-white/10 rounded px-2 py-1 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"}),"date"===a.field_type&&(0,b.jsx)(aL,{value:a.field_value,onChange:a=>{let b=[...U];b[c].field_value=a,V(b)}}),"number"===a.field_type&&(0,b.jsxs)("div",{className:"relative w-full",children:[(0,b.jsx)("input",{type:"text",inputMode:"numeric",value:a.field_value,onChange:a=>{let b=a.target.value.replace(/[^0-9.-]/g,""),d=[...U];d[c].field_value=b,V(d)},placeholder:"Warto≈õƒá liczbowa",className:"w-full bg-white/[0.04] border border-white/10 rounded px-2 py-1 pr-12 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"}),(0,b.jsxs)("div",{className:"absolute right-0.5 top-0 bottom-0 w-11 flex flex-col",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{let b=parseFloat(a.field_value)||0,d=[...U];d[c].field_value=String(b+1),V(d)},className:"flex-1 px-1 bg-white/[0.08] hover:bg-white/[0.15] border-l border-white/20 rounded-tl text-white/70 hover:text-white transition-colors flex items-center justify-center",title:"Zwiƒôksz",children:(0,b.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),(0,b.jsx)("div",{className:"h-px bg-white/20"}),(0,b.jsx)("button",{type:"button",onClick:()=>{let b=parseFloat(a.field_value)||0,d=[...U];d[c].field_value=String(Math.max(0,b-1)),V(d)},className:"flex-1 px-1 bg-white/[0.08] hover:bg-white/[0.15] border-l border-white/20 rounded-bl text-white/70 hover:text-white transition-colors flex items-center justify-center",title:"Zmniejsz",children:(0,b.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),"link"===a.field_type&&(0,b.jsx)("input",{type:"url",value:a.field_value,onChange:a=>{let b=[...U];b[c].field_value=a.target.value,V(b)},placeholder:"https://example.com",className:"w-full bg-white/[0.04] border border-white/10 rounded px-2 py-1 text-xs text-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-[#fee715]/40 focus:border-[#fee715]/30"}),(0,b.jsx)("div",{className:"flex justify-end mt-2",children:(0,b.jsxs)("button",{onClick:()=>{V(U.filter((a,b)=>b!==c))},className:"px-2 py-1 text-xs text-gray-400 hover:text-red-400 transition-colors flex items-center gap-1",title:"Usu≈Ñ pole",children:[(0,b.jsx)(au.Trash,{size:14,weight:"regular"}),(0,b.jsx)("span",{children:"Usu≈Ñ"})]})})]},c))})]}),(0,b.jsxs)("div",{className:"pt-3 mt-3 border-t border-white/10",children:[(0,b.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Zapisz jako w≈Çasny szablon"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(m.CustomSelect,{size:"sm",value:S.category||"Dzia≈Çania",onChange:a=>T({...S,category:a}),options:[{value:"≈πr√≥d≈Ça Ruchu",label:"≈πr√≥d≈Ça Ruchu"},{value:"Typ Strony",label:"Typ Strony"},{value:"Dzia≈Çania",label:"Dzia≈Çania"},{value:"Cel/Konwersja",label:"Cel/Konwersja"},{value:"Narzƒôdzia",label:"Narzƒôdzia"}],className:"w-full"}),(0,b.jsx)("button",{onClick:async()=>{if(!S.label||!S.icon)return void aw({isOpen:!0,title:"B≈ÇƒÖd",message:"Wype≈Çnij nazwƒô i wybierz ikonƒô przed zapisaniem szablonu.",type:"error"});let a=M?.data?.color||"#fee715";await bF(S.label,S.icon,a,S.category||"Dzia≈Çania")},className:"w-full px-3 py-1.5 bg-white/[0.06] border border-white/20 text-white/90 rounded text-sm font-medium hover:bg-white/10 hover:border-white/30 transition-colors",children:"Zapisz jako szablon"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-3 mt-3 border-t border-white/10",children:[(0,b.jsx)("button",{onClick:bX,className:"relative flex-1 px-3 py-1.5 bg-[#fee715]/10 border border-[#fee715]/40 text-[#fee715] rounded text-sm font-medium hover:bg-[#fee715]/15 hover:border-[#fee715]/50 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["Zapisz zmiany",a9&&(0,b.jsx)("span",{className:"w-1.5 h-1.5 bg-[#fee715] rounded-full animate-pulse",title:"Masz niezapisane zmiany"})]})}),(0,b.jsx)("button",{onClick:bY,className:"px-3 py-1.5 bg-white/[0.06] border border-white/20 text-white/90 rounded text-sm font-medium hover:bg-white/10 hover:border-white/30 transition-colors",children:"Usu≈Ñ"})]})]})]})]}),(0,b.jsx)(k.AlertModal,{isOpen:av.isOpen,title:av.title,message:av.message,type:av.type,onClose:()=>aw(a=>({...a,isOpen:!1}))}),az&&s&&(0,b.jsx)(p.CommentPanel,{funnelId:s,isOpen:az,onClose:()=>{aA(!1),aC(null)},onJumpToAnchor:(a,b,c)=>{if("node"===a&&b){let a=aT.find(a=>a.id===b);a&&bf&&(bf.setCenter(a.position.x,a.position.y,{zoom:1,duration:500}),N(a),P(!0))}else if("edge"===a&&b){let a=aW.find(a=>a.id===b);if(a&&bf){let b=aT.find(b=>b.id===a.source);b&&(bf.setCenter(b.position.x,b.position.y,{zoom:1,duration:500}),Z(a),ad(!0))}}else"region"===a&&c&&bf&&bf.setCenter(c.x,c.y,{zoom:1,duration:500})},onThreadClick:a=>{aC(a)}}),aB&&s&&(0,b.jsx)(q.CommentThread,{threadId:aB,funnelId:s,onClose:()=>{aC(null),bC()},onUpdate:()=>{bC()}}),aG&&s&&(0,b.jsx)(r.CommentForm,{funnelId:s,anchorType:aG.type,anchorId:aG.id,regionCoords:aG.coords,onClose:()=>{aM(null)},onSuccess:()=>{aM(null),bC(),aS(a=>a+1),az||aA(!0)}})]}):(0,b.jsx)("div",{className:"h-screen bg-[#101820] flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center text-white",children:[(0,b.jsx)("p",{className:"text-lg mb-4",children:"Lejek nie zosta≈Ç znaleziony"}),(0,b.jsx)("button",{onClick:()=>v.push("/admin/marketing"),className:"px-5 py-2.5 bg-[#fee715]/10 border border-[#fee715]/50 text-[#fee715] rounded-lg font-medium hover:bg-[#fee715]/20 hover:border-[#fee715]/70 transition-all duration-200",children:"Wr√≥ƒá do listy"})]})})}a.s(["DatePickerField",0,aL,"default",()=>aM])}];

//# sourceMappingURL=strony_www_drozniak-landingpage_app_admin_marketing_%5Bid%5D_page_tsx_8ff9ee5f._.js.map