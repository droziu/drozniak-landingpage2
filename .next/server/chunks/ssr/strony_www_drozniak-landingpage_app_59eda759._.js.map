{"version":3,"sources":["../../../../../../strony_www/drozniak-landingpage/app/hooks/useAuth.ts","../../../../../../strony_www/drozniak-landingpage/app/login/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { User } from '@supabase/supabase-js';\nimport { supabase } from '@/lib/supabase-client';\n\nexport const useAuth = () => {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // Sprawdź aktualną sesję\n    supabase.auth.getSession().then(({ data: { session }, error }) => {\n      if (error) {\n        console.error('Błąd pobierania sesji:', error);\n      }\n      console.log('Sesja załadowana:', session?.user?.email || 'brak sesji');\n      setUser(session?.user ?? null);\n      setLoading(false);\n    });\n\n    // Nasłuchuj zmian w autentykacji\n    const {\n      data: { subscription },\n    } = supabase.auth.onAuthStateChange((event, session) => {\n      console.log('Zmiana stanu autentykacji:', event, session?.user?.email || 'brak sesji');\n      setUser(session?.user ?? null);\n      setLoading(false);\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const signIn = async (email: string, password: string) => {\n    const { data, error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    });\n    return { data, error };\n  };\n\n  const updatePassword = async (newPassword: string) => {\n    const { data, error } = await supabase.auth.updateUser({\n      password: newPassword,\n    });\n    return { data, error };\n  };\n\n  const signOut = async () => {\n    const { error } = await supabase.auth.signOut();\n    return { error };\n  };\n\n  return {\n    user,\n    loading,\n    signIn,\n    signOut,\n    updatePassword,\n  };\n};\n","'use client';\n\nimport React, { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/app/hooks/useAuth';\nimport { Logo } from '@/components/icons/Logo';\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const { signIn } = useAuth();\n  const router = useRouter();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    setLoading(true);\n\n    const { data, error: signInError } = await signIn(email, password);\n\n    if (signInError) {\n      const errorMessage = signInError.message.toLowerCase();\n      \n      // Sprawdź czy to błąd związany z brakiem konfiguracji Supabase\n      if (errorMessage.includes('failed to fetch') || errorMessage.includes('network') || errorMessage.includes('name_not_resolved')) {\n        setError('Błąd połączenia z serwerem. Sprawdź, czy zmienne środowiskowe Supabase są poprawnie skonfigurowane w pliku .env.local');\n      } else if (errorMessage.includes('invalid login credentials') || errorMessage.includes('invalid credentials')) {\n        setError('Nieprawidłowy email lub hasło. Sprawdź dane i spróbuj ponownie.');\n      } else if (errorMessage.includes('email not confirmed') || errorMessage.includes('not confirmed')) {\n        setError('Email nie został potwierdzony. Sprawdź swoją skrzynkę email (również folder spam) i kliknij link aktywacyjny.');\n      } else if (errorMessage.includes('too many requests') || errorMessage.includes('rate limit')) {\n        setError('Zbyt wiele prób logowania. Poczekaj chwilę i spróbuj ponownie za kilka minut.');\n      } else if (errorMessage.includes('user not found')) {\n        setError('Nie znaleziono użytkownika z tym adresem email. Sprawdź adres email.');\n      } else {\n        setError(`Wystąpił błąd podczas logowania: ${signInError.message}. Spróbuj ponownie.`);\n      }\n      setLoading(false);\n    } else if (data?.user) {\n      // Logowanie udane - sprawdź email i przekieruj\n      const userEmail = data.user.email;\n      console.log('Logowanie udane, email:', userEmail);\n      setLoading(false);\n      \n      // Poczekaj chwilę, żeby sesja się zaktualizowała, potem przekieruj\n      setTimeout(() => {\n        if (userEmail === 'stanislaw@drozniak.com') {\n          console.log('Przekierowanie admina do /admin');\n          router.push('/admin');\n        } else {\n          console.log('Przekierowanie użytkownika do /panel');\n          router.push('/panel');\n        }\n      }, 200);\n    } else {\n      // Brak danych użytkownika - nieoczekiwany błąd\n      console.error('Logowanie udane, ale brak danych użytkownika:', data);\n      setError('Logowanie udane, ale wystąpił problem z pobraniem danych użytkownika. Spróbuj odświeżyć stronę.');\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-[#101820] flex items-center justify-center px-4 py-12\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <div className=\"flex justify-center mb-6\">\n            <Logo />\n          </div>\n          <h1 className=\"font-[Montserrat] text-3xl font-bold text-white mb-2\">\n            Panel Klienta\n          </h1>\n          <p className=\"text-gray-400\">\n            Zaloguj się, aby uzyskać dostęp do szkolenia\n          </p>\n        </div>\n\n        <div className=\"bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-8 shadow-xl\">\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            {/* Komunikat błędu */}\n            {error && (\n              <div className=\"bg-red-500/20 border border-red-500/50 rounded-lg p-4 text-red-200 text-sm flex items-start gap-3\">\n                <svg className=\"w-5 h-5 flex-shrink-0 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                </svg>\n                <div className=\"flex-1\">{error}</div>\n              </div>\n            )}\n\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-300 mb-2\">\n                Email\n              </label>\n              <input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                className=\"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#fee715] focus:border-transparent transition-all\"\n                placeholder=\"twoj@email.pl\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-300 mb-2\">\n                Hasło\n              </label>\n              <input\n                id=\"password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                className=\"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#fee715] focus:border-transparent transition-all\"\n                placeholder=\"••••••••\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full bg-gradient-to-r from-[#fee715] to-[#00C9A7] text-[#101820] font-[Montserrat] font-bold py-3 px-6 rounded-lg hover:shadow-2xl hover:shadow-[#fee715]/40 transform hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\"\n            >\n              {loading ? (\n                <span className=\"flex items-center justify-center gap-2\">\n                  <svg className=\"animate-spin h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                  </svg>\n                  Logowanie...\n                </span>\n              ) : (\n                'Zaloguj się'\n              )}\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}