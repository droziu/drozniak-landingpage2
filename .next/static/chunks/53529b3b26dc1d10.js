(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50506,68708,e=>{"use strict";var t=e.i(45366),r=(0,t.createContext)({color:"currentColor",size:"1em",weight:"regular",mirrored:!1}),n=function(e,t,r){var n=r.get(e);return n?n(t):(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),null)};function a(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}e.s(["IconContext",()=>r,"renderPathForWeight",()=>n],50506);var s=(0,t.forwardRef)(function(e,n){var s=e.alt,l=e.color,i=e.size,o=e.weight,d=e.mirrored,c=e.children,u=e.renderPath,m=a(e,["alt","color","size","weight","mirrored","children","renderPath"]),h=(0,t.useContext)(r),x=h.color,f=void 0===x?"currentColor":x,p=h.size,g=h.weight,k=h.mirrored,j=a(h,["color","size","weight","mirrored"]);return t.default.createElement("svg",Object.assign({ref:n,xmlns:"http://www.w3.org/2000/svg",width:null!=i?i:p,height:null!=i?i:p,fill:null!=l?l:f,viewBox:"0 0 256 256",transform:d||void 0!==k&&k?"scale(-1, 1)":void 0},j,m),!!s&&t.default.createElement("title",null,s),c,t.default.createElement("rect",{width:"256",height:"256",fill:"none"}),u(null!=o?o:void 0===g?"regular":g,null!=l?l:f))});s.displayName="IconBase",e.s(["default",0,s],68708)},94342,e=>{"use strict";var t=e.i(45366),r=e.i(50506),n=e.i(68708),a=new Map;a.set("bold",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M200,224H56a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h96l56,56V216A8,8,0,0,1,200,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.default.createElement("polyline",{points:"148 32 148 92 208 92",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.default.createElement("line",{x1:"96",y1:"132",x2:"160",y2:"132",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.default.createElement("line",{x1:"96",y1:"172",x2:"160",y2:"172",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))}),a.set("duotone",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("polygon",{points:"152 32 152 88 208 88 152 32",opacity:"0.2"}),t.default.createElement("path",{d:"M200,224H56a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h96l56,56V216A8,8,0,0,1,200,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("polyline",{points:"152 32 152 88 208 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("line",{x1:"96",y1:"136",x2:"160",y2:"136",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("line",{x1:"96",y1:"168",x2:"160",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))}),a.set("fill",function(){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M213.7,82.3l-56-56A8.1,8.1,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8.1,8.1,0,0,0,213.7,82.3ZM160,176H96a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Zm0-32H96a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Zm-8-56V44l44,44Z"}))}),a.set("light",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M200,224H56a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h96l56,56V216A8,8,0,0,1,200,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.default.createElement("polyline",{points:"152 32 152 88 208 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.default.createElement("line",{x1:"96",y1:"136",x2:"160",y2:"136",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.default.createElement("line",{x1:"96",y1:"168",x2:"160",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))}),a.set("thin",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M200,224H56a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h96l56,56V216A8,8,0,0,1,200,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.default.createElement("polyline",{points:"152 32 152 88 208 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.default.createElement("line",{x1:"96",y1:"136",x2:"160",y2:"136",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.default.createElement("line",{x1:"96",y1:"168",x2:"160",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))}),a.set("regular",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M200,224H56a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h96l56,56V216A8,8,0,0,1,200,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("polyline",{points:"152 32 152 88 208 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("line",{x1:"96",y1:"136",x2:"160",y2:"136",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("line",{x1:"96",y1:"168",x2:"160",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var s=function(e,t){return(0,r.renderPathForWeight)(e,t,a)},l=(0,t.forwardRef)(function(e,r){return t.default.createElement(n.default,Object.assign({ref:r},e,{renderPath:s}))});l.displayName="FileText",e.s(["FileText",0,l],94342)},49404,e=>{"use strict";var t=e.i(29883);e.s(["AlertModal",0,({isOpen:e,title:r,message:n,buttonText:a="OK",onClose:s,type:l="info"})=>{if(!e)return null;let i={success:{icon:(0,t.jsx)("svg",{className:"w-8 h-8 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),border:"border-green-500/50",bg:"bg-green-500/10"},error:{icon:(0,t.jsx)("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),border:"border-red-500/50",bg:"bg-red-500/10"},info:{icon:(0,t.jsx)("svg",{className:"w-8 h-8 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),border:"border-blue-500/50",bg:"bg-blue-500/10"},warning:{icon:(0,t.jsx)("svg",{className:"w-8 h-8 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),border:"border-yellow-500/50",bg:"bg-yellow-500/10"}}[l];return(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:s}),(0,t.jsxs)("div",{className:`relative bg-gradient-to-br from-[#18232F] to-[#101820] rounded-2xl border-2 ${i.border} shadow-2xl max-w-md w-full p-6 md:p-8 transform transition-all`,children:[(0,t.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:i.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-[Montserrat] text-2xl font-bold text-white mb-2",children:r}),(0,t.jsx)("p",{className:"text-gray-300 leading-relaxed",children:n})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{onClick:s,className:"px-6 py-3 bg-gradient-to-r from-[#fee715] to-[#00C9A7] text-[#101820] font-[Montserrat] font-bold rounded-xl transition-all duration-300 hover:shadow-lg hover:shadow-[#fee715]/40",children:a})})]})]})}])},56542,e=>{"use strict";var t=e.i(45366),r=e.i(50506),n=e.i(68708),a=new Map;a.set("bold",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M128,56C48,56,16,128,16,128s32,72,112,72,112-72,112-72S208,56,128,56Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"32",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))}),a.set("duotone",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M128,56C48,56,16,128,16,128s32,72,112,72,112-72,112-72S208,56,128,56Zm0,112a40,40,0,1,1,40-40A40,40,0,0,1,128,168Z",opacity:"0.2"}),t.default.createElement("path",{d:"M128,56C48,56,16,128,16,128s32,72,112,72,112-72,112-72S208,56,128,56Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))}),a.set("fill",function(){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M247.3,124.8c-.3-.8-8.8-19.6-27.6-38.5C194.6,61.3,162.9,48,128,48S61.4,61.3,36.3,86.3C17.5,105.2,9,124,8.7,124.8a7.9,7.9,0,0,0,0,6.4c.3.8,8.8,19.6,27.6,38.5C61.4,194.7,93.1,208,128,208s66.6-13.3,91.7-38.3c18.8-18.9,27.3-37.7,27.6-38.5A7.9,7.9,0,0,0,247.3,124.8ZM128,92a36,36,0,1,1-36,36A36,36,0,0,1,128,92Z"}))}),a.set("light",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M128,56C48,56,16,128,16,128s32,72,112,72,112-72,112-72S208,56,128,56Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))}),a.set("thin",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M128,56C48,56,16,128,16,128s32,72,112,72,112-72,112-72S208,56,128,56Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))}),a.set("regular",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M128,56C48,56,16,128,16,128s32,72,112,72,112-72,112-72S208,56,128,56Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var s=function(e,t){return(0,r.renderPathForWeight)(e,t,a)},l=(0,t.forwardRef)(function(e,r){return t.default.createElement(n.default,Object.assign({ref:r},e,{renderPath:s}))});l.displayName="Eye",e.s(["Eye",0,l],56542)},52376,e=>{"use strict";var t=e.i(45366),r=e.i(50506),n=e.i(68708),a=new Map;a.set("bold",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("polyline",{points:"172 104 113.3 160 84 132",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))}),a.set("duotone",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("circle",{cx:"128",cy:"128",r:"96",opacity:"0.2"}),t.default.createElement("polyline",{points:"172 104 113.3 160 84 132",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))}),a.set("fill",function(){return t.default.createElement(t.default.Fragment,null,t.default.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.2,104.2,0,0,0,128,24Zm49.5,85.8-58.6,56a8.1,8.1,0,0,1-5.6,2.2,7.7,7.7,0,0,1-5.5-2.2l-29.3-28a8,8,0,1,1,11-11.6l23.8,22.7,53.2-50.7a8,8,0,0,1,11,11.6Z"}))}),a.set("light",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("polyline",{points:"172 104 113.3 160 84 132",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))}),a.set("thin",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("polyline",{points:"172 104 113.3 160 84 132",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))}),a.set("regular",function(e){return t.default.createElement(t.default.Fragment,null,t.default.createElement("polyline",{points:"172 104 113.3 160 84 132",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.default.createElement("circle",{cx:"128",cy:"128",r:"96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var s=function(e,t){return(0,r.renderPathForWeight)(e,t,a)},l=(0,t.forwardRef)(function(e,r){return t.default.createElement(n.default,Object.assign({ref:r},e,{renderPath:s}))});l.displayName="CheckCircle",e.s(["CheckCircle",0,l],52376)},91044,e=>{"use strict";var t=e.i(45366),r=e.i(23448),n=e.i(55041);e.s(["useClientPanel",0,()=>{let{user:e}=(0,n.useAuth)(),[a,s]=(0,t.useState)(null),[l,i]=(0,t.useState)([]),[o,d]=(0,t.useState)(!0);(0,t.useEffect)(()=>{if(!e){s(null),i([]),d(!1);return}c()},[e?.id]);let c=async()=>{if(e){d(!0);try{let[e,t]=await Promise.all([r.supabase.rpc("get_my_panel_client"),r.supabase.rpc("get_my_view_grants")]);if(e.error){console.error("useClientPanel: get_my_panel_client error",e.error),console.error("useClientPanel: error details",JSON.stringify(e.error,null,2)),s(null),i([]);return}let n=Array.isArray(e.data)&&e.data.length>0?e.data[0]:null;if(s(n?{id:n.id,marketing_client_id:n.marketing_client_id}:null),!n)return void i([]);if(t.error){console.error("useClientPanel: get_my_view_grants error",t.error),i([]);return}let a=Array.isArray(t.data)?t.data:[];i(a.filter(e=>["documents","courses","marketing","data","projects"].includes(e)))}catch(e){console.error("useClientPanel load error:",e),s(null),i([])}finally{d(!1)}}};return{panelClient:a,viewGrants:l,loading:o,reload:c}}])},54140,e=>{"use strict";var t=e.i(29883),r=e.i(45366),n=e.i(7495),a=e.i(52454),s=e.i(55041),l=e.i(91044),i=e.i(35205),o=e.i(23448),d=e.i(60564),c=e.i(94342),u=e.i(52376),m=e.i(56542);let h=()=>{let{user:e}=(0,s.useAuth)(),{panelClient:n}=(0,l.useClientPanel)(),[a,i]=(0,r.useState)([]),[h,x]=(0,r.useState)([]),[f,p]=(0,r.useState)(!0);(0,r.useEffect)(()=>{e&&(async()=>{p(!0);let{data:e,error:t}=await o.supabase.from("client_documents").select("id, doc_type, name, file_url, created_at").order("created_at",{ascending:!1});if(t||i(e||[]),n){let{data:e,error:t}=await o.supabase.from("proposals").select("id, title, status, created_at, valid_until").order("created_at",{ascending:!1});!t&&e&&x(await Promise.all(e.map(async e=>{let{data:t}=await o.supabase.from("proposal_access_links").select("token").eq("proposal_id",e.id).eq("status","active").single();return{...e,access_link:t||null}})))}p(!1)})()},[e?.id,n?.id]);let g={offer:"Oferta",invoice:"Faktura",contract:"Umowa",other:"Inny"};return f?(0,t.jsx)(d.LoadingState,{variant:"block",label:"Ładowanie dokumentów…"}):a.length>0||h.length>0?(0,t.jsxs)("div",{className:"space-y-6",children:[h.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-base font-semibold text-white mb-3 flex items-center gap-2",children:[(0,t.jsx)(c.FileText,{size:18,weight:"regular"}),"Oferty"]}),(0,t.jsx)("ul",{className:"divide-y divide-white/10",children:h.map(e=>{var r;return(0,t.jsxs)("li",{className:"py-3 flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-white text-sm",children:e.title}),"accepted"===e.status&&(0,t.jsx)(u.CheckCircle,{size:16,weight:"bold",className:"text-green-400"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[(0,t.jsx)("span",{className:`text-xs ${{draft:"text-gray-400",sent:"text-blue-400",viewed:"text-purple-400",accepted:"text-green-400",expired:"text-gray-500",archived:"text-gray-500"}[e.status]||"text-gray-400"}`,children:{draft:"Szkic",sent:"Wysłana",viewed:"Otworzona",accepted:"Zaakceptowana",expired:"Wygasła",archived:"Zarchiwizowana"}[r=e.status]||r}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString("pl-PL")}),e.valid_until&&(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["Ważna do: ",new Date(e.valid_until).toLocaleDateString("pl-PL")]})]})]}),e.access_link?(0,t.jsxs)("button",{onClick:()=>{e.access_link&&window.open(`/p/${e.access_link.token}`,"_blank")},className:"flex items-center gap-1 px-3 py-1.5 bg-[#fee715] text-[#101820] rounded-lg hover:bg-[#fee715]/90 text-xs font-semibold transition-all",children:[(0,t.jsx)(m.Eye,{size:14,weight:"regular"}),"Otwórz"]}):(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Brak linku"})]},e.id)})})]}),a.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-white mb-3",children:"Umowy i dokumenty"}),(0,t.jsx)("ul",{className:"divide-y divide-white/10",children:a.map(e=>(0,t.jsxs)("li",{className:"py-3 flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-white text-sm",children:e.name}),(0,t.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",g[e.doc_type]||e.doc_type,")"]})]}),e.file_url&&(0,t.jsx)("a",{href:e.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-[#00C9A7] hover:underline",children:"Pobierz"})]},e.id))})]})]}):(0,t.jsxs)("div",{className:"py-8 px-4 rounded-lg bg-white/5 border border-white/10 text-center",children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Brak dokumentów i ofert"}),(0,t.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Oferty, faktury i umowy pojawią się tutaj po dodaniu przez administratora."})]})},x=({panelClient:e})=>{let a=(0,n.useRouter)(),[s,l]=(0,r.useState)([]),[i,c]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{if(!e?.marketing_client_id){l([]),c(!1);return}(async()=>{c(!0);let{data:t,error:r}=await o.supabase.from("funnel_diagrams").select("id, project_name, status, updated_at").in("status",["active","draft"]);if(r){l([]),c(!1);return}let{data:n}=await o.supabase.from("funnel_access").select("funnel_id").eq("client_id",e.marketing_client_id),a=new Set((n||[]).map(e=>e.funnel_id));l((t||[]).filter(e=>a.has(e.id))),c(!1)})()},[e?.marketing_client_id]),i)?(0,t.jsx)(d.LoadingState,{variant:"block",label:"Ładowanie lejków…"}):e?.marketing_client_id&&0!==s.length?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-white mb-3",children:"Lejki marketingowe"}),(0,t.jsx)("ul",{className:"divide-y divide-white/10",children:s.map(e=>(0,t.jsxs)("li",{className:"py-3 flex items-center justify-between gap-3",children:[(0,t.jsx)("span",{className:"text-white text-sm",children:e.project_name}),(0,t.jsx)("button",{type:"button",onClick:()=>a.push(`/panel/marketing/${e.id}`),className:"text-xs text-[#00C9A7] hover:underline",children:"Otwórz"})]},e.id))})]}):(0,t.jsxs)("div",{className:"py-8 px-4 rounded-lg bg-white/5 border border-white/10 text-center",children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Brak lejków"}),(0,t.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Lejki marketingowe przypisane do Twojego konta pojawią się tutaj."})]})};var f=e.i(49404);let p=()=>{let{user:e}=(0,s.useAuth)(),[n,a]=(0,r.useState)(!0),[l,i]=(0,r.useState)(!1),[c,u]=(0,r.useState)({company_name:"",first_name:"",last_name:"",phone:"",notes:"",email:"",display_name:""}),[m,h]=(0,r.useState)({isOpen:!1,title:"",message:"",type:"info"});(0,r.useEffect)(()=>{e&&(u(t=>({...t,email:e.email||""})),(async()=>{let[t,r]=await Promise.all([o.supabase.from("profiles").select("*").eq("id",e.id).maybeSingle(),o.supabase.from("panel_clients").select("*").eq("user_id",e.id).maybeSingle()]);!t.error&&t.data&&u(r=>({...r,company_name:t.data.company_name||"",first_name:t.data.first_name||"",last_name:t.data.last_name||"",phone:t.data.phone||"",notes:t.data.notes||"",email:e.email||""})),!r.error&&r.data?u(e=>({...e,display_name:r.data?.display_name||""})):r.error&&"PGRST116"!==r.error.code&&r.error.message?.includes("400")&&console.warn("Kolumna display_name może nie istnieć w panel_clients:",r.error),a(!1)})())},[e?.id]);let x=async t=>{if(t.preventDefault(),e){i(!0);try{let t=[c.first_name,c.last_name].filter(Boolean).join(" ")||null,{error:r}=await o.supabase.from("profiles").upsert({id:e.id,company_name:c.company_name||null,first_name:c.first_name||null,last_name:c.last_name||null,phone:c.phone||null,notes:c.notes||null,full_name:t,updated_at:new Date().toISOString()},{onConflict:"id"});if(r)throw r;let{data:n}=await o.supabase.from("panel_clients").select("id").eq("user_id",e.id).maybeSingle();if(n){let{error:e}=await o.supabase.from("panel_clients").update({display_name:c.display_name.trim()||null}).eq("id",n.id);if(e)throw e}h({isOpen:!0,title:"Sukces",message:"Dane zapisane.",type:"success"})}catch(e){h({isOpen:!0,title:"Błąd",message:e?.message||"Błąd zapisu.",type:"error"})}finally{i(!1)}}};return n?(0,t.jsx)(d.LoadingState,{variant:"inline",label:"Ładowanie danych…"}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-white",children:"Dane"}),(0,t.jsxs)("form",{onSubmit:x,className:"bg-white/5 rounded-lg p-4 border border-white/10 space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Email"}),(0,t.jsx)("input",{type:"email",value:c.email,readOnly:!0,disabled:!0,className:"w-full bg-white/10 border border-white/10 rounded px-3 py-2 text-sm text-gray-400"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Nazwa firmy"}),(0,t.jsx)("input",{type:"text",value:c.company_name,onChange:e=>u(t=>({...t,company_name:e.target.value})),placeholder:"Nazwa firmy",className:"w-full bg-white/5 border border-white/10 rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:ring-1 focus:ring-[#fee715] focus:border-[#fee715]"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Imię"}),(0,t.jsx)("input",{type:"text",value:c.first_name,onChange:e=>u(t=>({...t,first_name:e.target.value})),placeholder:"Imię",className:"w-full bg-white/5 border border-white/10 rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:ring-1 focus:ring-[#fee715] focus:border-[#fee715]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Nazwisko"}),(0,t.jsx)("input",{type:"text",value:c.last_name,onChange:e=>u(t=>({...t,last_name:e.target.value})),placeholder:"Nazwisko",className:"w-full bg-white/5 border border-white/10 rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:ring-1 focus:ring-[#fee715] focus:border-[#fee715]"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Telefon"}),(0,t.jsx)("input",{type:"tel",value:c.phone,onChange:e=>u(t=>({...t,phone:e.target.value})),placeholder:"Telefon",className:"w-full bg-white/5 border border-white/10 rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:ring-1 focus:ring-[#fee715] focus:border-[#fee715]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Preferowane imię"}),(0,t.jsx)("input",{type:"text",value:c.display_name,onChange:e=>u(t=>({...t,display_name:e.target.value})),placeholder:"np. Franek",className:"w-full bg-white/5 border border-white/10 rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:ring-1 focus:ring-[#fee715] focus:border-[#fee715]"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Opcjonalne pole z preferowaną formą imienia."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Notatki / cele"}),(0,t.jsx)("textarea",{value:c.notes,onChange:e=>u(t=>({...t,notes:e.target.value})),placeholder:"Notatki...",rows:3,className:"w-full bg-white/5 border border-white/10 rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:ring-1 focus:ring-[#fee715] focus:border-[#fee715] resize-none"})]}),(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsx)("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-[#fee715] text-[#101820] text-sm font-semibold rounded-lg hover:bg-[#fee715]/90 disabled:opacity-50",children:l?"Zapisywanie…":"Zapisz"})})]}),(0,t.jsx)(f.AlertModal,{isOpen:m.isOpen,title:m.title,message:m.message,type:m.type,onClose:()=>h(e=>({...e,isOpen:!1}))})]})},g=()=>{let{user:e}=(0,s.useAuth)(),[n,a]=(0,r.useState)([]),[l,i]=(0,r.useState)(!0);(0,r.useEffect)(()=>{e&&(async()=>{i(!0);let{data:e,error:t}=await o.supabase.from("client_projects").select("id, project_type, name, status, updated_at").order("updated_at",{ascending:!1});t||a(e||[]),i(!1)})()},[e?.id]);let c={draft:"Szkic",in_progress:"W trakcie",review:"Do akceptacji",completed:"Zakończony",on_hold:"Wstrzymany"},u={website:"Strona WWW",other:"Inny"};return l?(0,t.jsx)(d.LoadingState,{variant:"block",label:"Ładowanie projektów…"}):0===n.length?(0,t.jsxs)("div",{className:"py-8 px-4 rounded-lg bg-white/5 border border-white/10 text-center",children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Brak projektów"}),(0,t.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Projekty (np. strona www) i ich status pojawią się tutaj po dodaniu."})]}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-white mb-3",children:"Projekty"}),(0,t.jsx)("ul",{className:"divide-y divide-white/10",children:n.map(e=>(0,t.jsxs)("li",{className:"py-3 flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-white text-sm",children:e.name}),(0,t.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",u[e.project_type]||e.project_type,")"]})]}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:c[e.status]||e.status})]},e.id))})]})};var k=e.i(3373);let j=()=>{let{courses:e,loading:a}=(()=>{let{user:e}=(0,s.useAuth)(),[t,n]=(0,r.useState)([]),[a,l]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(!e){n([]),l(!1);return}i()},[e?.id]);let i=async()=>{if(e){l(!0);try{let{data:t,error:r}=await o.supabase.from("user_courses").select(`
          course_id,
          courses (
            id,
            code,
            name,
            description,
            config_path,
            active
          )
        `).eq("user_id",e.id).eq("active",!0).order("assigned_at",{ascending:!1});if(r)throw r;let a=(t||[]).map(e=>e.courses).filter(Boolean);if(0===a.length){n([]),l(!1);return}let{data:s,error:i}=await o.supabase.from("training_progress").select("course_id, module_code, percentage, module_completed").eq("user_id",e.id).in("course_id",a.map(e=>e.id));if(i)throw i;let d=a.map(e=>{let t=(0,k.loadCourseModules)(e.config_path),r=t.reduce((e,t)=>e+t.lessons.length,0),n=0;t.forEach(t=>{let r=`modul_${t.id}`,a=(s||[]).find(t=>t.course_id===e.id&&t.module_code===r),l=a?.module_completed?100:a?.percentage??0;n+=t.lessons.length*l/100});let a=r>0?Math.round(n/r*100):0;return{id:e.id,code:e.code,name:e.name,description:e.description,config_path:e.config_path,completionPercent:a}});n(d)}catch(e){console.error("useUserCourses:",e),n([])}finally{l(!1)}}};return{courses:t,loading:a,reload:i}})(),l=(0,n.useRouter)();return a?(0,t.jsx)(d.LoadingState,{variant:"block",label:"Ładowanie kursów…",skeleton:"cards"}):0===e.length?(0,t.jsxs)("div",{className:"py-8 text-center",children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Brak przypisanych kursów."}),(0,t.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"Skontaktuj się z administratorem."})]}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-white mb-4",children:"Twoje kursy"}),(0,t.jsx)("div",{className:"grid gap-3 sm:grid-cols-2",children:e.map(e=>(0,t.jsx)(b,{course:e,onOpen:()=>l.push(`/panel/courses/${e.id}`)},e.id))})]})},b=({course:e,onOpen:r})=>(0,t.jsx)("div",{className:"rounded-xl border border-white/10 bg-white/[0.03] p-4 hover:bg-white/[0.05] transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-white text-sm truncate",children:e.name}),(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex-1 h-1.5 bg-white/10 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-[#fee715] to-[#00C9A7] rounded-full transition-all",style:{width:`${Math.min(100,e.completionPercent)}%`}})}),(0,t.jsxs)("span",{className:"text-xs text-gray-400 tabular-nums flex-shrink-0",children:[e.completionPercent,"%"]})]})]}),(0,t.jsx)("button",{onClick:r,className:"flex-shrink-0 px-3 py-1.5 rounded-lg bg-[#fee715] text-[#101820] text-xs font-semibold hover:bg-[#fee715]/90 transition-colors",title:"Otwórz w trybie pełnoekranowym",children:"Otwórz"})]})}),y={documents:{path:"documents",label:"Umowy i dokumenty"},courses:{path:"courses",label:"Kursy"},marketing:{path:"marketing",label:"Marketing"},data:{path:"data",label:"Dane"},projects:{path:"projects",label:"Projekty"}},w=["data","documents","courses","marketing","projects"];function v({params:e}){let[o,c]=(0,r.useState)(null),{user:u,loading:m,updatePassword:f}=(0,s.useAuth)(),{panelClient:k,viewGrants:b,loading:v}=(0,l.useClientPanel)(),N=(0,n.useRouter)(),_=(0,n.usePathname)(),[L,E]=(0,r.useState)(!1),[C,W]=(0,r.useState)(""),[S,z]=(0,r.useState)(""),[M,P]=(0,r.useState)(null),[A,F]=(0,r.useState)(null),[O,Z]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e.then(c)},[e]);let B=_.replace(/^\/panel\/?/,"")||"",H=B.split("/")[0]||"",V=w.filter(e=>b.includes(e));if((0,r.useEffect)(()=>{if(!v&&!m&&V.length>0&&(!B||""===B)){let e=y[V[0]];e&&N.replace(`/panel/${e.path}`)}},[v,m,V,B,N]),m||v||!o)return(0,t.jsx)(d.LoadingState,{variant:"fullscreen",label:"Ładowanie panelu…"});if(!u)return N.push("/login"),null;if(!k)return(0,t.jsx)("div",{className:"min-h-screen bg-[#101820] flex items-center justify-center px-4",children:(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Nie masz przypisanego konta klienta."}),(0,t.jsx)("p",{className:"text-gray-500 text-xs",children:"Skontaktuj się z administratorem."})]})});if(0===b.length)return(0,t.jsx)("div",{className:"min-h-screen bg-[#101820] flex items-center justify-center px-4",children:(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Brak przypisanych modułów."}),(0,t.jsx)("p",{className:"text-gray-500 text-xs",children:"Skontaktuj się z administratorem."})]})});if(!B||""===B)return(0,t.jsx)(d.LoadingState,{variant:"fullscreen",label:"Ładowanie…"});let T=async e=>{if(e.preventDefault(),P(null),F(null),Z(!0),C.length<6){P("Hasło musi mieć co najmniej 6 znaków."),Z(!1);return}if(C!==S){P("Hasła nie są identyczne."),Z(!1);return}let{error:t}=await f(C);if(t){let e=t.message.toLowerCase();e.includes("same")||e.includes("identical")?P("Nowe hasło musi być inne niż obecne."):e.includes("weak")?P("Hasło jest zbyt słabe. Użyj silniejszego hasła."):P(`Wystąpił błąd: ${t.message}. Spr\xf3buj ponownie.`),Z(!1)}else F("Hasło zostało zmienione pomyślnie!"),W(""),z(""),Z(!1),setTimeout(()=>{E(!1),F(null)},2e3)};return(0,t.jsxs)("div",{className:"min-h-screen bg-[#101820] text-white flex flex-col",children:[(0,t.jsxs)("header",{className:"flex-shrink-0 flex items-center justify-between px-4 py-3 border-b border-white/10 bg-[#101820]/95",children:[(0,t.jsx)("h1",{className:"font-[Montserrat] text-base font-semibold text-white",children:"Panel klienta"}),(0,t.jsx)(i.UserMenu,{onPasswordChange:()=>E(!0),onProfileClick:()=>N.push("/panel/data")})]}),(0,t.jsxs)("div",{className:"flex flex-1 min-h-0",children:[(0,t.jsx)("aside",{className:"flex-shrink-0 w-48 border-r border-white/10 bg-white/[0.02] py-3",children:(0,t.jsx)("nav",{className:"px-2 space-y-0.5",children:V.map(e=>{let{path:r,label:n}=y[e],s=`/panel/${r}`,l=H===e;return(0,t.jsx)(a.default,{href:s,className:`block px-3 py-2 rounded-lg text-sm transition-colors ${l?"bg-[#fee715]/20 text-[#fee715]":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:n},e)})})}),(0,t.jsx)("main",{className:"flex-1 overflow-auto px-4 py-4",children:"documents"===H?(0,t.jsx)(h,{}):"courses"===H?(0,t.jsx)(j,{}):"marketing"===H?(0,t.jsx)(x,{panelClient:k}):"data"===H?(0,t.jsx)(p,{}):"projects"===H?(0,t.jsx)(g,{}):null})]}),L&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center px-4",children:(0,t.jsxs)("div",{className:"bg-[#18232F] border border-white/10 rounded-xl p-6 md:p-8 max-w-md w-full shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"font-[Montserrat] text-base font-bold text-white",children:"Zmień hasło"}),(0,t.jsx)("button",{onClick:()=>{E(!1),P(null),F(null),W(""),z("")},className:"text-gray-400 hover:text-white transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("form",{onSubmit:T,className:"space-y-5",children:[A&&(0,t.jsxs)("div",{className:"bg-green-500/20 border border-green-500/50 rounded-lg p-4 text-green-200 text-sm flex items-start gap-3",children:[(0,t.jsx)("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)("div",{className:"flex-1",children:A})]}),M&&(0,t.jsxs)("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4 text-red-200 text-sm flex items-start gap-3",children:[(0,t.jsx)("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)("div",{className:"flex-1",children:M})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-300 mb-2",children:["Nowe hasło",(0,t.jsx)("span",{className:"text-gray-500 text-xs ml-2",children:"(min. 6 znaków)"})]}),(0,t.jsx)("input",{id:"newPassword",type:"password",value:C,onChange:e=>W(e.target.value),required:!0,minLength:6,className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#fee715] focus:border-transparent transition-all",placeholder:"••••••••"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"confirmNewPassword",className:"block text-sm font-medium text-gray-300 mb-2",children:"Potwierdź nowe hasło"}),(0,t.jsx)("input",{id:"confirmNewPassword",type:"password",value:S,onChange:e=>z(e.target.value),required:!0,minLength:6,className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#fee715] focus:border-transparent transition-all",placeholder:"••••••••"})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{E(!1),P(null),F(null),W(""),z("")},className:"flex-1 bg-white/10 text-white font-[Montserrat] font-bold py-3 px-6 rounded-lg hover:bg-white/20 transition-all duration-300",children:"Anuluj"}),(0,t.jsx)("button",{type:"submit",disabled:O,className:"flex-1 bg-gradient-to-r from-[#fee715] to-[#00C9A7] text-[#101820] font-[Montserrat] font-bold py-3 px-6 rounded-lg hover:shadow-2xl hover:shadow-[#fee715]/40 transform hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:O?(0,t.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Zmienianie..."]}):"Zmień hasło"})]})]})]})})]})}e.s(["default",()=>v],54140)}]);